<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add linear penalties — add_linear_penalties • prioritizr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Add linear penalties — add_linear_penalties"><meta property="og:description" content="Add penalties to a conservation planning problem() to penalize
solutions that select planning units with higher values from a specific
data source (e.g., anthropogenic impact). These penalties assume
a linear trade-off between the penalty values and the primary
objective of the conservation planning problem() (e.g.,
solution cost for minimum set problems; add_min_set_objective()."><meta property="og:image" content="https://prioritizr.net/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.2.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/package_overview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/gurobi_installation_guide.html">Gurobi installation guide</a>
    </li>
    <li>
      <a href="../articles/solver_benchmarks.html">Solver benchmarks</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication record</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/connectivity_tutorial.html">Connectivity</a>
    </li>
    <li>
      <a href="../articles/calibrating_trade-offs_tutorial.html">Calibrating trade-offs</a>
    </li>
    <li>
      <a href="../articles/management_zones_tutorial.html">Management zones</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/prioritizr/prioritizr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add linear penalties</h1>
    <small class="dont-index">Source: <a href="https://github.com/prioritizr/prioritizr/blob/HEAD/R/add_linear_penalties.R" class="external-link"><code>R/add_linear_penalties.R</code></a></small>
    <div class="hidden name"><code>add_linear_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add penalties to a conservation planning <code><a href="problem.html">problem()</a></code> to penalize
solutions that select planning units with higher values from a specific
data source (e.g., anthropogenic impact). These penalties assume
a linear trade-off between the penalty values and the primary
objective of the conservation planning <code><a href="problem.html">problem()</a></code> (e.g.,
solution cost for minimum set problems; <code><a href="add_min_set_objective.html">add_min_set_objective()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for ConservationProblem,ANY,character</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ConservationProblem,ANY,numeric</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ConservationProblem,ANY,matrix</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ConservationProblem,ANY,Matrix</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ConservationProblem,ANY,Raster</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ConservationProblem,ANY,dgCMatrix</span></span>
<span><span class="fu">add_linear_penalties</span><span class="op">(</span><span class="va">x</span>, <span class="va">penalty</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code><a href="problem.html">problem()</a></code> (i.e., <code><a href="ConservationProblem-class.html">ConservationProblem</a></code>) object.</p></dd>


<dt>penalty</dt>
<dd><p><code>numeric</code> penalty value that is used to scale the
importance not selecting planning units with high <code>data</code> values.
Higher <code>penalty</code> values can be used to obtain solutions that
are strongly averse to selecting places with high <code>data</code>
values, and smaller <code>penalty</code> values can be used to obtain solutions
that only avoid places with especially high <code>data</code> values.
Note that negative
<code>penalty</code> values can be used to obtain solutions that prefer places
with high <code>data</code> values. Additionally, when adding these
penalties to problems with multiple zones, the argument to <code>penalty</code>
must have a value for each zone.</p></dd>


<dt>data</dt>
<dd><p><code>character</code>, <code>numeric</code>,
<code><a href="https://rdrr.io/pkg/raster/man/Raster-classes.html" class="external-link">Raster</a></code>, <code>matrix</code>, or <code>Matrix</code> object
containing the values used to penalize solutions. Planning units that are
associated with higher data values are penalized more strongly
in the solution. See the Data format section for more information.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Object (i.e., <code><a href="ConservationProblem-class.html">ConservationProblem</a></code>) with the penalties
added to it.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function penalizes solutions that have higher values according
to the sum of the penalty values associated with each planning unit,
weighted by status of each planning unit in the solution.</p>
    </div>
    <div id="data-format">
    <h2>Data format</h2>
    


<p>The argument to <code>data</code> can be specified using the following formats.</p>
<dl><dt><code>data</code> as <code>character</code> vector</dt>
<dd><p>containing field (column) name(s) that
contain penalty values for planning units. This format is only
compatible if the planning units in the argument to <code>x</code> are a
<code><a href="https://rdrr.io/pkg/sp/man/Spatial-class.html" class="external-link">Spatial</a></code>, <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf()</a></code>, or
<code>data.frame</code> object. The fields (columns) must have <code>numeric</code>
values, and must not contain any missing (<code>NA</code>) values.
For problems that contain a single zone, the argument to <code>data</code> must
contain a single field name. Otherwise, for problems that
contain multiple zones, the argument to <code>data</code> must
contain a field name for each zone.</p></dd>


<dt><code>data</code> as a <code>numeric</code> vector</dt>
<dd><p>containing values for
planning units. These values must not contain any missing
(<code>NA</code>) values. Note that this format is only available
for planning units that contain a single zone.</p></dd>


<dt><code>data</code> as a <code>matrix</code>/<code>Matrix</code> object</dt>
<dd><p>containing <code>numeric</code> values
that specify data for each planning unit.
Each row corresponds to a planning unit, each column corresponds to a
zone, and each cell indicates the data for penalizing a planning unit
when it is allocated to a given zone.</p></dd>


<dt><code>data</code> as a <code><a href="https://rdrr.io/pkg/raster/man/Raster-classes.html" class="external-link">Raster</a></code> object</dt>
<dd><p>containing values for planning
units. This format is only
compatible if the planning units in the argument to <code>x</code> are
<code><a href="https://rdrr.io/pkg/sp/man/Spatial-class.html" class="external-link">Spatial</a></code>, <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf()</a></code>, or
<code><a href="https://rdrr.io/pkg/raster/man/Raster-classes.html" class="external-link">Raster</a></code> objects.
If the planning unit data are a <code><a href="https://rdrr.io/pkg/sp/man/Spatial-class.html" class="external-link">Spatial</a></code> or
<code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf()</a></code> object, then the values are calculated by overlaying the
planning units with the argument to <code>data</code> and calculating the sum of the
values associated with each planning unit.
If the planning unit data are a
<code><a href="https://rdrr.io/pkg/raster/man/Raster-classes.html" class="external-link">Raster</a></code> object then the values are calculated by extracting the
cell
values (note that the planning unit data and the argument to <code>data</code> must
have exactly the same dimensionality, extent, and missingness).
For problems involving multiple zones, the argument to <code>data</code> must
contain a layer for each zone.</p></dd>



</dl></div>
    <div id="mathematical-formulation">
    <h2>Mathematical formulation</h2>
    

<p>The linear penalties are implemented using the following
equations.
Let \(I\) denote the set of planning units
(indexed by \(i\)), \(Z\) the set of management zones (indexed by
\(z\)), and \(X_{iz}\) the decision variable for allocating
planning unit \(i\) to zone \(z\) (e.g., with binary
values indicating if each planning unit is allocated or not). Also, let
\(P_z\) represent the penalty scaling value for zones
\(z \in Z\) (argument to <code>penalty</code>), and
\(D_{iz}\) the penalty data for allocating planning unit
\(i \in I\) to zones \(z \in Z\) (argument to
<code>data</code>, if supplied as a <code>matrix</code> object).</p>
<p>$$
\sum_{i}^{I} \sum_{z}^{Z} P_z \times D_{iz} \times X_{iz}
$$</p>
<p>Note that when the problem objective is to maximize some measure of
benefit and not minimize some measure of cost, the term \(P_z\) is
replaced with \(-P_z\).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <a href="penalties.html">penalties</a> for an overview of all functions for adding penalties.</p>
<p>Other penalties: 
<code><a href="add_asym_connectivity_penalties.html">add_asym_connectivity_penalties</a>()</code>,
<code><a href="add_boundary_penalties.html">add_boundary_penalties</a>()</code>,
<code><a href="add_connectivity_penalties.html">add_connectivity_penalties</a>()</code>,
<code><a href="add_feature_weights.html">add_feature_weights</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># set seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">600</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, <span class="va">sim_pu_zones_stack</span>, <span class="va">sim_features</span>, <span class="va">sim_features_zones</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a column to contain the penalty data for each planning unit</span></span></span>
<span class="r-in"><span><span class="co"># e.g., these values could indicate the level of habitat</span></span></span>
<span class="r-in"><span><span class="va">sim_pu_polygons</span><span class="op">$</span><span class="va">penalty_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="OptimizationProblem-methods.html">nrow</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the penalty data to visualise its spatial distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, zcol <span class="op">=</span> <span class="st">"penalty_data"</span>, main <span class="op">=</span> <span class="st">"penalty data"</span>,</span></span>
<span class="r-in"><span>       axes <span class="op">=</span> <span class="cn">FALSE</span>, box <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_linear_penalties-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create minimal problem with minimum set objective,</span></span></span>
<span class="r-in"><span><span class="co"># this does not use the penalty data</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, <span class="va">sim_features</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_default_solver.html">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print problem</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Conservation Problem</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   planning units: SpatialPolygonsDataFrame (90 units)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   cost:           min: 190.13276, max: 215.86384</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   objective:      Minimum set objective </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   decisions:      Binary decision </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   constraints:    &lt;none&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   penalties:      &lt;none&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   portfolio:      default</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solver:         Gurobi [first_feasible (0), gap (0.1), node_file_start (-1), numeric_focus (0), presolve (2), threads (1), time_limit (2147483647), verbose (0)]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create an updated version of the previous problem,</span></span></span>
<span class="r-in"><span><span class="co"># with the penalties added to it</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">add_linear_penalties</span><span class="op">(</span><span class="fl">100</span>, data <span class="op">=</span> <span class="st">"penalty_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print problem</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Conservation Problem</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   planning units: SpatialPolygonsDataFrame (90 units)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   cost:           min: 190.13276, max: 215.86384</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   objective:      Minimum set objective </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   decisions:      Binary decision </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   constraints:    &lt;none&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   penalties:      &lt;Linear penalties [penalty (100)]&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   portfolio:      default</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solver:         Gurobi [first_feasible (0), gap (0.1), node_file_start (-1), numeric_focus (0), presolve (2), threads (1), time_limit (2147483647), verbose (0)]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># solve the two problems</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="solve.html">solve</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="solve.html">solve</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the solutions and compare them,</span></span></span>
<span class="r-in"><span><span class="co"># since we supplied a very high penalty value (i.e., 100), relative</span></span></span>
<span class="r-in"><span><span class="co"># to the range of values in the penalty data and the objective function,</span></span></span>
<span class="r-in"><span><span class="co"># the solution in s2 is very sensitive to values in the penalty data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">s1</span>, zcol <span class="op">=</span> <span class="st">"solution_1"</span>, main <span class="op">=</span> <span class="st">"solution without penalties"</span>,</span></span>
<span class="r-in"><span>       axes <span class="op">=</span> <span class="cn">FALSE</span>, box <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_linear_penalties-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">s2</span>, zcol <span class="op">=</span> <span class="st">"solution_1"</span>, main <span class="op">=</span> <span class="st">"solution with penalties"</span>,</span></span>
<span class="r-in"><span>       axes <span class="op">=</span> <span class="cn">FALSE</span>, box <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_linear_penalties-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for real conservation planning exercises,</span></span></span>
<span class="r-in"><span><span class="co"># it would be worth exploring a range of penalty values (e.g., ranging</span></span></span>
<span class="r-in"><span><span class="co"># from 1 to 100 increments of 5) to explore the trade-offs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now, let's examine a conservation planning exercise involving multiple</span></span></span>
<span class="r-in"><span><span class="co"># management zones</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create targets for each feature within each zone,</span></span></span>
<span class="r-in"><span><span class="co"># these targets indicate that each zone needs to represent 10% of the</span></span></span>
<span class="r-in"><span><span class="co"># spatial distribution of each feature</span></span></span>
<span class="r-in"><span><span class="va">targ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.1</span>, ncol <span class="op">=</span> <span class="fu"><a href="number_of_zones.html">number_of_zones</a></span><span class="op">(</span><span class="va">sim_features_zones</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               nrow <span class="op">=</span> <span class="fu"><a href="number_of_features.html">number_of_features</a></span><span class="op">(</span><span class="va">sim_features_zones</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create penalty data for allocating each planning unit to each zone,</span></span></span>
<span class="r-in"><span><span class="co"># these data will be generated by simulating values</span></span></span>
<span class="r-in"><span><span class="va">penalty_stack</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_cost.html">simulate_cost</a></span><span class="op">(</span><span class="va">sim_pu_zones_stack</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                               n <span class="op">=</span> <span class="fu"><a href="number_of_zones.html">number_of_zones</a></span><span class="op">(</span><span class="va">sim_features_zones</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the penalty data, each layer corresponds to a different zone</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">penalty_stack</span>, main <span class="op">=</span> <span class="st">"penalty data"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, box <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_linear_penalties-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a multi-zone problem with the minimum set objective</span></span></span>
<span class="r-in"><span><span class="co"># and penalties for allocating planning units to each zone,</span></span></span>
<span class="r-in"><span><span class="co"># with a penalty scaling factor of 1 for each zone</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_zones_stack</span>, <span class="va">sim_features_zones</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="va">targ</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu">add_linear_penalties</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">penalty_stack</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="add_default_solver.html">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print problem</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print.html">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Conservation Problem</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   zones:          zone_1, zone_2, zone_3 (3 zones)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   planning units: RasterStack (90 units)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   cost:           min: 182.60173, max: 224.84924</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   features:       feature_1, feature_2, feature_3, ... (5 features)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   objective:      Minimum set objective </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   decisions:      Binary decision </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   constraints:    &lt;none&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   penalties:      &lt;Linear penalties [penalty (min: 1, max: 1)]&gt;</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   portfolio:      default</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   solver:         Gurobi [first_feasible (0), gap (0.1), node_file_start (-1), numeric_focus (0), presolve (2), threads (1), time_limit (2147483647), verbose (0)]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># solve problem</span></span></span>
<span class="r-in"><span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="solve.html">solve</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot solution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="category_layer.html">category_layer</a></span><span class="op">(</span><span class="va">s3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"multi-zone solution"</span>,</span></span>
<span class="r-in"><span>     axes <span class="op">=</span> <span class="cn">FALSE</span>, box <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_linear_penalties-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com" class="external-link">Richard Schuster</a>, Nina Morrell, <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Brandon P M Edwards, Matthew E Watts, <a href="https://arcese.forestry.ubc.ca" class="external-link">Peter Arcese</a>, <a href="https://josephrbennett.wordpress.com" class="external-link">Joseph Bennett</a>, <a href="http://www.possinghamlab.org" class="external-link">Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

