<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add boundary penalties — add_boundary_penalties • prioritizr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Add boundary penalties — add_boundary_penalties" />
<meta property="og:description" content="Add penalties to a conservation planning problem to favour
solutions that have planning units clumped together into contiguous areas." />
<meta property="og:image" content="https://prioritizr.net/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add boundary penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_boundary_penalties.R'><code>R/add_boundary_penalties.R</code></a></small>
    <div class="hidden name"><code>add_boundary_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add penalties to a conservation planning <code><a href='problem.html'>problem</a></code> to favour
solutions that have planning units clumped together into contiguous areas.</p>
    </div>

    <pre class="usage"><span class='fu'>add_boundary_penalties</span>(
  <span class='no'>x</span>,
  <span class='no'>penalty</span>,
  <span class='kw'>edge_factor</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.5</span>, <span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>x</span>)),
  <span class='kw'>zones</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>x</span>)),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units that are spatially clumped together compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code><a href='add_min_set_objective.html'>add_min_set_objective</a></code>). Higher <code>penalty</code> values
will return solutions with a higher degree of spatial clumping,
and smaller <code>penalty</code> values will return solutions with a smaller
degree of clumping. Note that negative <code>penalty</code> values will
return solutions that are more spread out. This parameter is equivalent to
the boundary length modifier (BLM)
parameter in <a href='https://marxansolutions.org/'><em>Marxan</em></a>.</p></td>
    </tr>
    <tr>
      <th>edge_factor</th>
      <td><p><code>numeric</code> proportion to scale
planning unit edges (or borders) that do not have any neighboring planning
units. For example, an edge factor of <code>0.5</code> is commonly used for
planning units along the coast line. Note that this argument must have an
element for each zone in the argument to <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
clumping scheme for different zones. Each row and column corresponds to a
different zone in the argument to <code>x</code>, and cell values indicate the
relative importance of clumping planning units that are allocated to
a pair of zones. Cell values along the diagonal of the matrix represent
the relative importance of clumping planning units that are allocated
to the same zone. Cell values must lay between 1 and -1, where negative
values favor solutions that spread out planning units. The default
argument to <code>zones</code> is an identity
matrix (i.e. a matrix with ones along the matrix diagonal and zeros
elsewhere), so that penalties are incurred when neighboring planning units
are not assigned to the same zone. <strong>Note that if the cells along
the matrix diagonal contain markedly lower values than cells found
elsewhere in the matrix, then the optimal solution may surround
planning units with planning units that are allocated to different zones.</strong></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>NULL</code>, <code>data.frame</code>, <code>matrix</code>, or <code>Matrix</code>
object containing the boundary data. The boundary values
correspond to the shared boundary length between different planning units
and the amount of exposed boundary length that each planning unit has
which is not shared with any other planning unit. Given a certain
<code>penalty</code> value, it is more desirable to select combinations of
planning units which do not expose larger boundaries that are shared
between different planning units. See the Details section for more
information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function adds penalties to a conservation planning problem
  to penalize fragmented solutions. It was is inspired by Ball <em>et al.</em>
  (2009) and Beyer <em>et al.</em> (2016). The <code>penalty</code> argument is
  equivalent to the boundary length modifier (<code>BLM</code>) used in
  <a href='https://marxansolutions.org'><em>Marxan</em></a>.
  Note that this function can only
  be used to represent symmetric relationships between planning units. If
  asymmetric relationships are required, use the
  <code><a href='add_connectivity_penalties.html'>add_connectivity_penalties</a></code> function.</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl'>

  <dt><code>NULL</code></dt><dd><p>the boundary data are automatically calculated
    using the <code><a href='boundary_matrix.html'>boundary_matrix</a></code> function. This argument is the
    default. Note that the boundary data must be manually defined
    using one of the other formats below when the planning unit data
    in the argument to <code>x</code> is not spatially referenced (e.g.
    in <code>data.frame</code> or <code>numeric</code> format).</p></dd>

  <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    amount of shared boundary length between two different planning units.
    Cells that occur along the matrix diagonal represent the amount of
    exposed boundary associated with each planning unit that has
    no neighbor (e.g. these value might pertain the length of coastline
    in a planning unit).</p></dd>

  <dt><code>data.frame</code></dt><dd><p>containing the columns <code>"id1"</code>,
    <code>"id2"</code>, and <code>"boundary"</code>. The values in the column
    <code>"boundary"</code> show the total amount of shared boundary between the
    two planning units indicated the columns <code>"id1"</code> and <code>"id2"</code>.
    This format follows the the standard <em>Marxan</em> input format. Note
    that this function requires symmetric boundary data, and so the
    argument to <code>data</code> cannot have the columns <code>"zone1"</code> and
    code"zone2" to specify different amounts of shared boundary lengths
    for different zones. Instead, when dealing with problems with multiple
    zones, the argument to <code>zones</code> should be used to control the
    relative importance of spatially clumping planning units together when
    they are allocated to different zones.</p></dd>

  
</dl>

<p>The boundary penalties are calculated using the following equations. Let
  \(I\) represent the set of planning units
  (indexed by \(i\) or \(j\)), \(Z\) represent
  the set of management zones (indexed by \(z\) or \(y\)), and
  \(X_{iz}\) represent the decision
  variable for planning unit \(i\) for in zone \(z\) (e.g. with binary
  values one indicating if planning unit is allocated or not). Also, let
  \(p\) represent the argument to <code>penalty</code>, \(E\) represent the
  argument to <code>edge_factor</code>, \(B\) represent the matrix argument to
  <code>data</code> (e.g. generated using <code><a href='boundary_matrix.html'>boundary_matrix</a></code>), and
  \(W\) represent the matrix argument to <code>zones</code>.</p>
<p>$$
  \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} (\mathit{ifelse}(i == j, E_z, 1)
  \times p \times W_{zz} B_{ij}) + \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z}
  \sum_{y}^{Z} (-2 \times p \times X_{iz} \times X_{jy} \times W_{zy} \times
  B_{ij})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(p\) is
 replaced with \(-p\).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ball IR, Possingham HP, and Watts M (2009) <em>Marxan and relatives:
Software for spatial conservation prioritisation</em> in Spatial conservation
prioritisation: Quantitative methods and computational tools. Eds Moilanen
A, Wilson KA, and Possingham HP. Oxford University Press, Oxford, UK.</p>
<p>Beyer HL, Dujardin Y, Watts ME, and Possingham HP (2016) Solving
conservation planning problems with integer linear programming.
<em>Ecological Modelling</em>, 228: 14--22.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seed for reproducibility</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>500</span>)

<span class='co'># load data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># create minimal problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>()

<span class='co'># create problem with low boundary penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>)

<span class='co'># create problem with high boundary penalties but outer edges receive</span>
<span class='co'># half the penalty as inner edges</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='fl'>0.5</span>)

<span class='co'># create a problem using precomputed boundary data</span>
<span class='no'>bmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_raster</span>)
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>bmat</span>)

<span class='co'># \donttest{</span>
<span class='co'># solve problems</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/stack.html'>stack</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p4</span>))</div><div class='output co'>#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Model fingerprint: 0xac25e0fe
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 4544.4850483
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.899056e+03, 12 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3899.05601    0    4 4544.48505 3899.05601  14.2%     -    0s
#&gt; H    0     0                    3988.8131278 3899.05601  2.25%     -    0s
#&gt; 
#&gt; Explored 1 nodes (12 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3988.81 4544.49 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.988813127763e+03, best bound 3.899056011987e+03, gap 2.2502%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Model fingerprint: 0xb7af95e4
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18847.196992
#&gt; Found heuristic solution: objective 4724.4850483
#&gt; Presolve time: 0.01s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.064320e+03, 186 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4064.31993    0   52 4724.48505 4064.31993  14.0%     -    0s
#&gt; H    0     0                    4196.4791919 4064.31993  3.15%     -    0s
#&gt; 
#&gt; Explored 1 nodes (186 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 4196.48 4724.49 18847.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.196479191930e+03, best bound 4.064319933597e+03, gap 3.1493%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Model fingerprint: 0x2604fb63
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 20287.196992
#&gt; Found heuristic solution: objective 5594.4850483
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.531725e+03, 219 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4531.72483    0  234 5594.48505 4531.72483  19.0%     -    0s
#&gt;      0     0 4604.44812    0  232 5594.48505 4604.44812  17.7%     -    0s
#&gt;      0     0 4664.43086    0  225 5594.48505 4664.43086  16.6%     -    0s
#&gt;      0     0 4667.41801    0  229 5594.48505 4667.41801  16.6%     -    0s
#&gt;      0     0 4669.60093    0  229 5594.48505 4669.60093  16.5%     -    0s
#&gt;      0     0 4685.65525    0  222 5594.48505 4685.65525  16.2%     -    0s
#&gt;      0     0 4694.51190    0  204 5594.48505 4694.51190  16.1%     -    0s
#&gt;      0     0 4694.56564    0  204 5594.48505 4694.56564  16.1%     -    0s
#&gt;      0     0 4694.56564    0  204 5594.48505 4694.56564  16.1%     -    0s
#&gt; H    0     0                    5330.7252629 4694.56564  11.9%     -    0s
#&gt; H    0     0                    5175.1807047 4694.56564  9.29%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 1 nodes (470 simplex iterations) in 0.14 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 5175.18 5330.73 5594.49 20287.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.175180704712e+03, best bound 4.694565636923e+03, gap 9.2869%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Model fingerprint: 0xb7af95e4
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18847.196992
#&gt; Found heuristic solution: objective 4724.4850483
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.064320e+03, 186 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4064.31993    0   52 4724.48505 4064.31993  14.0%     -    0s
#&gt; H    0     0                    4196.4791919 4064.31993  3.15%     -    0s
#&gt; 
#&gt; Explored 1 nodes (186 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 4196.48 4724.49 18847.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.196479191930e+03, best bound 4.064319933597e+03, gap 3.1493%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>s</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"basic solution"</span>, <span class='st'>"small penalties"</span>, <span class='st'>"high penalties"</span>,
                 <span class='st'>"precomputed data"</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
<span class='co'># create minimal problem with multiple zones and limit the run-time for</span>
<span class='co'># solver to 10 seconds so this example doesn't take too long</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0.2</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># create zone matrix which favors clumping planning units that are</span>
<span class='co'># allocated to the same zone together - note that this is the default</span>
<span class='no'>zm6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>3</span>)
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm6</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix and low penalties</span>
<span class='no'>p6</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create another problem with the same zone matrix and higher penalties</span>
<span class='no'>p7</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create zone matrix which favors clumping units that are allocated to</span>
<span class='co'># different zones together</span>
<span class='no'>zm8</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>zm8</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm8</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p8</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm8</span>)

<span class='co'># create zone matrix which strongly favors clumping units</span>
<span class='co'># that are allocated to the same zone together. It will also prefer</span>
<span class='co'># clumping planning units in zones 1 and 2 together over having</span>
<span class='co'># these planning units with no neighbors in the solution</span>
<span class='no'>zm9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>3</span>)
<span class='no'>zm9</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.3</span>, <span class='fl'>0</span>, <span class='fl'>0</span>)
<span class='no'>zm9</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>lower.tri</a></span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='no'>zm9</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>zm9</span>)]
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm9</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.3    0
#&gt; [2,]  0.3  1.0    0
#&gt; [3,]  0.0  0.0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p9</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm9</span>)

<span class='co'># create zone matrix which favors clumping planning units in zones 1 and 2</span>
<span class='co'># together, and favors planning units in zone 3 being spread out</span>
<span class='co'># (i.e. negative clumping)</span>
<span class='no'>zm10</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>3</span>)
<span class='no'>zm10</span>[<span class='fl'>3</span>, <span class='fl'>3</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm10</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0   -1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p10</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm10</span>)

<span class='co'># \donttest{</span>
<span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/stack.html'>stack</a></span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p5</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p6</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p7</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p8</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p9</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p10</span>)))</div><div class='output co'>#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Model fingerprint: 0x168289c2
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 13103.242827
#&gt; Presolve time: 0.01s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.199145e+04, 211 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 11991.4483    0   18 13103.2428 11991.4483  8.48%     -    0s
#&gt; 
#&gt; Explored 0 nodes (211 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 1: 13103.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.310324282660e+04, best bound 1.199144828715e+04, gap 8.4849%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 975 rows, 705 columns and 3360 nonzeros
#&gt; Model fingerprint: 0x9ae2b322
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 14008.242827
#&gt; Presolve time: 0.02s
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.228259e+04, 575 iterations, 0.07 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 12282.5861    0  310 14008.2428 12282.5861  12.3%     -    0s
#&gt; H    0     0                    13778.654077 12282.5861  10.9%     -    0s
#&gt; H    0     0                    13659.707836 12282.5861  10.1%     -    0s
#&gt; H    0     0                    13451.469667 12282.5861  8.69%     -    0s
#&gt; 
#&gt; Explored 1 nodes (575 simplex iterations) in 0.13 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 13451.5 13659.7 13778.7 14008.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.345146966676e+04, best bound 1.228258611787e+04, gap 8.6896%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 975 rows, 705 columns and 3360 nonzeros
#&gt; Model fingerprint: 0x3ccabb57
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 22153.242827
#&gt; Presolve time: 0.02s
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 975 rows, 705 columns, 3360 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.362015e+04, 655 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13620.1452    0  655 22153.2428 13620.1452  38.5%     -    0s
#&gt; H    0     0                    20154.993440 13620.1452  32.4%     -    0s
#&gt;      0     0 13770.3047    0  624 20154.9934 13770.3047  31.7%     -    0s
#&gt; H    0     0                    19969.144300 13770.3047  31.0%     -    0s
#&gt;      0     0 13878.2308    0  604 19969.1443 13878.2308  30.5%     -    0s
#&gt;      0     0 13881.4949    0  614 19969.1443 13881.4949  30.5%     -    0s
#&gt;      0     0 13911.8533    0  611 19969.1443 13911.8533  30.3%     -    0s
#&gt; H    0     0                    18843.311920 13911.8533  26.2%     -    0s
#&gt;      0     0 13911.8533    0  611 18843.3119 13911.8533  26.2%     -    0s
#&gt; H    0     0                    16204.385441 13911.8533  14.1%     -    0s
#&gt; H    0     0                    15678.285614 13911.8533  11.3%     -    0s
#&gt;      0     2 13912.0561    0  611 15678.2856 13912.0561  11.3%     -    0s
#&gt; H  135   104                    15521.904375 14011.2044  9.73%  32.6    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 8
#&gt; 
#&gt; Explored 136 nodes (5394 simplex iterations) in 1.32 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 7: 15521.9 15678.3 16204.4 ... 22153.2
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.552190437486e+04, best bound 1.401120436180e+04, gap 9.7327%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Model fingerprint: 0xada27267
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 8303.2428266
#&gt; Presolve time: 0.05s
#&gt; Presolved: 1845 rows, 1140 columns, 6840 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 975 rows, 1140 columns, 4230 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.576990e+03, 1715 iterations, 0.13 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2576.99025    0  235 8303.24283 2576.99025  69.0%     -    0s
#&gt; H    0     0                    2881.3718971 2576.99025  10.6%     -    0s
#&gt; H    0     0                    2794.5621583 2576.99025  7.79%     -    0s
#&gt; 
#&gt; Explored 1 nodes (1800 simplex iterations) in 0.36 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 2794.56 2881.37 8303.24 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.794562158270e+03, best bound 2.576990253978e+03, gap 7.7855%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 1555 rows, 995 columns and 4520 nonzeros
#&gt; Model fingerprint: 0xae681357
#&gt; Variable types: 0 continuous, 995 integer (995 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 21613.242827
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1555 rows, 995 columns, 5680 nonzeros
#&gt; Variable types: 0 continuous, 995 integer (995 binary)
#&gt; Presolve removed 580 rows and 0 columns
#&gt; Presolved: 975 rows, 995 columns, 3940 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.362015e+04, 729 iterations, 0.06 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13620.1452    0  655 21613.2428 13620.1452  37.0%     -    0s
#&gt; H    0     0                    20679.750176 13620.1452  34.1%     -    0s
#&gt; H    0     0                    20023.371279 13620.1452  32.0%     -    0s
#&gt;      0     0 13745.4959    0  683 20023.3713 13745.4959  31.4%     -    0s
#&gt; H    0     0                    16814.522531 13745.4959  18.3%     -    0s
#&gt;      0     0 13745.7308    0  683 16814.5225 13745.7308  18.3%     -    0s
#&gt;      0     0 13831.7639    0  604 16814.5225 13831.7639  17.7%     -    0s
#&gt;      0     0 13844.7800    0  593 16814.5225 13844.7800  17.7%     -    0s
#&gt;      0     0 13863.6022    0  594 16814.5225 13863.6022  17.5%     -    0s
#&gt;      0     0 13863.6022    0  594 16814.5225 13863.6022  17.5%     -    0s
#&gt;      0     2 13864.0559    0  594 16814.5225 13864.0559  17.5%     -    0s
#&gt; H   27    27                    15944.410066 13866.0795  13.0%  53.9    1s
#&gt; H   54    54                    15730.031779 13866.0795  11.8%  41.9    1s
#&gt; H  116    75                    15585.976112 13876.1302  11.0%  36.8    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 9
#&gt; 
#&gt; Explored 290 nodes (11724 simplex iterations) in 2.40 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 7: 15586 15730 15944.4 ... 21613.2
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.558597611216e+04, best bound 1.403676075946e+04, gap 9.9398%
#&gt; Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
#&gt; Optimize a model with 1120 rows, 705 columns and 3795 nonzeros
#&gt; Model fingerprint: 0xe02f3708
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 15601.521733
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1120 rows, 705 columns, 3940 nonzeros
#&gt; Variable types: 0 continuous, 705 integer (705 binary)
#&gt; Presolved: 1120 rows, 705 columns, 3940 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 9.328641e+03, 598 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 9328.64105    0  481 15601.5217 9328.64105  40.2%     -    0s
#&gt; H    0     0                    13044.004782 9328.64105  28.5%     -    0s
#&gt; H    0     0                    12904.982021 9328.64105  27.7%     -    0s
#&gt;      0     0 9365.33880    0  432 12904.9820 9365.33880  27.4%     -    0s
#&gt;      0     0 9366.98721    0  433 12904.9820 9366.98721  27.4%     -    0s
#&gt;      0     0 9419.01666    0  495 12904.9820 9419.01666  27.0%     -    0s
#&gt; H    0     0                    12721.479342 9419.01666  26.0%     -    0s
#&gt;      0     0 9437.43529    0  445 12721.4793 9437.43529  25.8%     -    0s
#&gt; H    0     0                    12537.815277 9437.43529  24.7%     -    0s
#&gt;      0     0 9438.92869    0  439 12537.8153 9438.92869  24.7%     -    0s
#&gt;      0     0 9468.77042    0  444 12537.8153 9468.77042  24.5%     -    0s
#&gt; H    0     0                    12536.982752 9468.77042  24.5%     -    0s
#&gt;      0     0 9468.97121    0  452 12536.9828 9468.97121  24.5%     -    0s
#&gt;      0     0 9476.40339    0  490 12536.9828 9476.40339  24.4%     -    0s
#&gt;      0     0 9481.28491    0  494 12536.9828 9481.28491  24.4%     -    0s
#&gt;      0     0 9481.28491    0  494 12536.9828 9481.28491  24.4%     -    0s
#&gt; H    0     0                    10821.329400 9481.28491  12.4%     -    0s
#&gt;      0     2 9481.69481    0  494 10821.3294 9481.69481  12.4%     -    0s
#&gt; H   54    42                    10555.622013 9510.15787  9.90%  52.0    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 3
#&gt;   Zero half: 29
#&gt; 
#&gt; Explored 55 nodes (3884 simplex iterations) in 1.06 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 8: 10555.6 10821.3 12537 ... 15601.5
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.055562201321e+04, best bound 9.510157867559e+03, gap 9.9043%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>s2</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"basic solution"</span>, <span class='st'>"within zone clumping (low)"</span>,
                  <span class='st'>"within zone clumping (high)"</span>, <span class='st'>"between zone clumping"</span>,
                  <span class='st'>"within + between clumping"</span>, <span class='st'>"negative clumping"</span>),
     <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-2.png' alt='' width='700' height='433' /></div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='https://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com'>Joseph Bennett</a>, <a href='http://www.possinghamlab.org'>Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


