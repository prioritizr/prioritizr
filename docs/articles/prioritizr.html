<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started • prioritizr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started">
<meta property="og:description" content="prioritizr">
<meta property="og:image" content="https://prioritizr.net/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.2.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/package_overview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/gurobi_installation_guide.html">Gurobi installation guide</a>
    </li>
    <li>
      <a href="../articles/solver_benchmarks.html">Solver benchmarks</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication record</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/connectivity_tutorial.html">Connectivity</a>
    </li>
    <li>
      <a href="../articles/calibrating_trade-offs_tutorial.html">Calibrating trade-offs</a>
    </li>
    <li>
      <a href="../articles/management_zones_tutorial.html">Management zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prioritizr/prioritizr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prioritizr/prioritizr/blob/HEAD/vignettes/prioritizr.Rmd" class="external-link"><code>vignettes/prioritizr.Rmd</code></a></small>
      <div class="hidden name"><code>prioritizr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The aim of this tutorial is to provide a short introduction to the <em>prioritizr R</em> package. It is also intended to help conservation planners familiar the <em>Marxan</em> decision support tool <span class="citation">(Ball <em>et al.</em> 2009)</span> start using the package for their work.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Let’s load the packages and data used in this tutorial. Since this tutorial uses data from the <em>prioritizrdata R</em> package, please ensure that it is installed. The data used in this tutorial were obtained from the <em>Introduction to Marxan</em> course. Specifically, the data were originally a subset of a larger spatial prioritization project performed under contract to Australia’s Department of Environment and Water Resources <span class="citation">(Klein <em>et al.</em> 2007)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.github.io/prioritizrdata/" class="external-link">prioritizrdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.net">prioritizr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load planning unit data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load feature data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tas_features</span><span class="op">)</span></span></code></pre></div>
<p>The <code>tas_pu</code> object contains planning units represented as spatial polygons (i.e., a <code>SpatialPolygonsDataFrame</code> object). This object has three columns that denote the following information for each planning unit: a unique identifier (<code>id</code>), unimproved land value (<code>cost</code>), and current conservation status (<code>locked_in</code>). Planning units that have at least half of their area overlapping with existing protected areas are denoted with a locked in value of 1, otherwise they are denoted with a value of 0. If you are familiar with the <em>Marxan</em> decision support tool, then you will notice that some of these columns are formatted similar conventions.</p>
<p>Now, let’s have a look at the planning unit data. We can see that the planning units correspond to hexagonal land parcels. We can also see that is a clear spatial pattern in the cost and conservation status the planning units.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print planning unit data</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatialPolygonsDataFrame </span></span>
<span><span class="co">## features    : 1130 </span></span>
<span><span class="co">## extent      : 298809.6, 613818.8, 5167775, 5502544  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## crs         : +proj=utm +zone=55 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></span>
<span><span class="co">## variables   : 5</span></span>
<span><span class="co">## names       :   id,              cost, status, locked_in, locked_out </span></span>
<span><span class="co">## min values  :    1, 0.192488262910798,      0,         0,          0 </span></span>
<span><span class="co">## max values  : 1130,  61.9272727272727,      2,         1,          0</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot map of planning unit costs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">[</span>, <span class="st">"cost"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Planning unit costs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-4-1.png" width="336" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot map of planning unit coverage by protected areas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">[</span>, <span class="st">"locked_in"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Protected area coverage"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-4-2.png" width="336" style="display: block; margin: auto;"></p>
<p>The <code>tas_features</code> object describes the spatial distribution of the features. Specifically, the feature data are expressed as a stack of 62 rasters (i.e., a <code>RasterStack</code> object). Each layer in the stack corresponds to one of 62 different vegetation communities. To describe the spatial distribution of a given vegetation community, each layer contains a spatially referenced grid of rectangular cells and each of these grid cells is associated with information on the distribution of the a given vegetation community. Specifically, these grid cells are assigned values that indicate if a given vegetation community is present (using value of 1) or absent (using value of 0) within the spatial extent of each grid cell.</p>
<p>Next, let’s examine the feature data. Here we will only plot the first four features as an example. The pixel values denote the presence (denoted by a value of 1) or absence (denoted by a value of zero) of each feature within the extent of the study area.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print planning unit data</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">tas_features</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class      : RasterStack </span></span>
<span><span class="co">## dimensions : 398, 359, 142882, 62  (nrow, ncol, ncell, nlayers)</span></span>
<span><span class="co">## resolution : 1000, 1000  (x, y)</span></span>
<span><span class="co">## extent     : 288801.7, 647801.7, 5142976, 5540976  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## crs        : +proj=utm +zone=55 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></span>
<span><span class="co">## names      : tas_features.1, tas_features.2, tas_features.3, tas_features.4, tas_features.5, tas_features.6, tas_features.7, tas_features.8, tas_features.9, tas_features.10, tas_features.11, tas_features.12, tas_features.13, tas_features.14, tas_features.15, ... </span></span>
<span><span class="co">## min values :              0,              0,              0,              0,              0,              0,              0,              0,              0,               0,               0,               0,               0,               0,               0, ... </span></span>
<span><span class="co">## max values :              1,              1,              1,              1,              1,              1,              1,              1,              1,               1,               1,               1,               1,               1,               1, ...</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot map of the first four vegetation classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tas_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Feature"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-5-1.png" width="432" style="display: block; margin: auto;"></p>
<p>The planning units in this tutorial are stored as spatial polygons. Although spatial polygons provide considerable flexibility in the shape and size of the planning units, such flexibility comes at a cost. This is because the spatial data processing routines needed to combine spatial polygon data and raster data for optimization can be very computationally expensive (e.g., calculating zonal statistics). As a consequence, we generally recommend using raster-based planning unit data where possible to reduce processing time. Another strategy is to complete spatial data processing routines manually using other software (e.g., <em>ESRI ArcGIS</em>) and use the pre-processed data directly with the <em>prioritizr R</em> package.</p>
</div>
<div class="section level2">
<h2 id="problem-formulation">Problem formulation<a class="anchor" aria-label="anchor" href="#problem-formulation"></a>
</h2>
<p>Now we will formulate a conservation planing problem. To achieve this, we first specify which objects contain the planning unit and feature data (using the <code><a href="../reference/problem.html">problem()</a></code> function). Next, we specify that we want to use the minimum set objective function (using the <code><a href="../reference/add_min_set_objective.html">add_min_set_objective()</a></code> function). This objective function indicates that we wish to minimize the total cost of planning units selected by the prioritization. We then specify boundary penalties reduce spatial fragmentation in the resulting prioritization (using the <code><a href="../reference/add_boundary_penalties.html">add_boundary_penalties()</a></code> function; see the <a href="calibrating_trade-offs_tutorial.html"><em>Calibrating trade-offs</em> vignette</a> for details on calibrating the penalty value). We also specify representation targets to ensure the resulting prioritization provides adequate coverage of each vegetation community (using the <code><a href="../reference/add_relative_targets.html">add_relative_targets()</a></code> function). Specifically, we specify targets to ensure at least 17% of the spatial extent of each vegetation community (based on the <a href="https://www.cbd.int/sp/targets/" class="external-link">Aichi Target 11</a>). Additionally, we set constraints to ensure that planning units predominately covered by existing protected areas are selected by the prioritization (using the <code><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints()</a></code> function). Finally, we specify that the prioritization should either select – or not select – planning units for prioritization (using the <code><a href="../reference/add_binary_decisions.html">add_binary_decisions()</a></code> function).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build problem</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">tas_pu</span>, <span class="va">tas_features</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_boundary_penalties.html">add_boundary_penalties</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.17</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="st">"locked_in"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print the problem</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Conservation Problem</span></span>
<span><span class="co">##   planning units: SpatialPolygonsDataFrame (1130 units)</span></span>
<span><span class="co">##   cost:           min: 0.19249, max: 61.92727</span></span>
<span><span class="co">##   features:       tas_features.1, tas_features.2, tas_features.3, ... (62 features)</span></span>
<span><span class="co">##   objective:      Minimum set objective </span></span>
<span><span class="co">##   targets:        Relative targets [targets (min: 0.17, max: 0.17)]</span></span>
<span><span class="co">##   decisions:      Binary decision </span></span>
<span><span class="co">##   constraints:    &lt;Locked in planning units [257 locked units]&gt;</span></span>
<span><span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 0.5, max: 0.5), penalty (0.005), zones]&gt;</span></span>
<span><span class="co">##   portfolio:      default</span></span>
<span><span class="co">##   solver:         default</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="prioritization">Prioritization<a class="anchor" aria-label="anchor" href="#prioritization"></a>
</h2>
<p>We can now solve the problem formulation (<code>p1</code>) to generate a prioritization (using the <code><a href="../reference/solve.html">solve()</a></code> function). The <em>prioritizr</em> R package supports a range of different exact algorithm solvers, including <em>Gurobi</em>, <em>IBM CPLEX</em>, <em>CBC</em>, <em>HiGHS</em>, <em>Rsymphony</em>, and <em>lpsymphony</em>. Although there are benefits and limitations associated with each of these different solvers, they should return similar results. Note that you will need at least one solver installed on your system to generate prioritizations. Since we did not specify a solver when building the problem, the <em>prioritizr R</em> package will automatically select the best available solver installed. We recommend using the <em>Gurobi</em> solver if possible, and have used it for this tutorial (see the <em>Gurobi Installation Guide</em> vignette for installation instructions). After solving the problem, the prioritization will be stored in the <code>solution_1</code> column of the <code>s1</code> object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solve problem</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gurobi Optimizer version 10.0.0 build v10.0.0rc2 (linux64)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]</span></span>
<span><span class="co">## Thread count: 4 physical cores, 8 logical processors, using up to 1 threads</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimize a model with 6358 rows, 4278 columns and 14496 nonzeros</span></span>
<span><span class="co">## Model fingerprint: 0x861c9b00</span></span>
<span><span class="co">## Variable types: 0 continuous, 4278 integer (4278 binary)</span></span>
<span><span class="co">## Coefficient statistics:</span></span>
<span><span class="co">##   Matrix range     [2e-06, 4e+01]</span></span>
<span><span class="co">##   Objective range  [5e-01, 2e+02]</span></span>
<span><span class="co">##   Bounds range     [1e+00, 1e+00]</span></span>
<span><span class="co">##   RHS range        [1e-01, 1e+02]</span></span>
<span><span class="co">## Found heuristic solution: objective 36805.575211</span></span>
<span><span class="co">## Found heuristic solution: objective 27817.085072</span></span>
<span><span class="co">## Presolve removed 2077 rows and 1375 columns</span></span>
<span><span class="co">## Presolve time: 0.12s</span></span>
<span><span class="co">## Presolved: 4281 rows, 2903 columns, 9594 nonzeros</span></span>
<span><span class="co">## Found heuristic solution: objective 24454.499456</span></span>
<span><span class="co">## Variable types: 0 continuous, 2903 integer (2903 binary)</span></span>
<span><span class="co">## Found heuristic solution: objective 23413.987477</span></span>
<span><span class="co">## Root relaxation presolved: 4281 rows, 2903 columns, 9594 nonzeros</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Root relaxation: objective 1.955605e+04, 1793 iterations, 0.26 seconds (0.19 work units)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Nodes    |    Current Node    |     Objective Bounds      |     Work</span></span>
<span><span class="co">##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      0     0 19556.0531    0 1615 23413.9875 19556.0531  16.5%     -    0s</span></span>
<span><span class="co">## H    0     0                    23045.733138 19556.0531  15.1%     -    0s</span></span>
<span><span class="co">## H    0     0                    22977.771015 19556.0531  14.9%     -    0s</span></span>
<span><span class="co">##      0     0 19835.6369    0 1833 22977.7710 19835.6369  13.7%     -    0s</span></span>
<span><span class="co">## H    0     0                    21705.306602 19835.6369  8.61%     -    0s</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cutting planes:</span></span>
<span><span class="co">##   Gomory: 2</span></span>
<span><span class="co">##   Cover: 5</span></span>
<span><span class="co">##   MIR: 5</span></span>
<span><span class="co">##   GUB cover: 1</span></span>
<span><span class="co">##   Zero half: 2</span></span>
<span><span class="co">##   RLT: 11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Explored 1 nodes (2467 simplex iterations) in 0.99 seconds (0.55 work units)</span></span>
<span><span class="co">## Thread count was 1 (of 8 available processors)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Solution count 7: 21705.3 22977.8 23045.7 ... 36805.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimal solution found (tolerance 1.00e-01)</span></span>
<span><span class="co">## Best objective 2.170530660204e+04, best bound 1.983563686947e+04, gap 8.6139%</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot map of prioritization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">s1</span><span class="op">[</span>, <span class="st">"solution_1"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Prioritization"</span>,</span>
<span>     pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-7-1.png" width="336" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="feature-representation">Feature representation<a class="anchor" aria-label="anchor" href="#feature-representation"></a>
</h2>
<p>Let’s examine how well the vegetation communities are represented by existing protected areas and the prioritization.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create column with existing protected areas</span></span>
<span><span class="va">tas_pu</span><span class="op">$</span><span class="va">pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">$</span><span class="va">locked_in</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate feature representation statistics based on existing protected areas</span></span>
<span><span class="va">tc_pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_target_coverage_summary.html">eval_target_coverage_summary</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">tas_pu</span><span class="op">[</span>, <span class="st">"pa"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">tc_pa</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 62 × 9</span></span></span>
<span><span class="co">##    feature         met   total…¹ absol…² absol…³ absol…⁴ relat…⁵ relat…⁶ relat…⁷</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> tas_features.1  FALSE    33.9    5.77   0.556    5.21    0.17  0.016<span style="text-decoration: underline;">4</span>  0.154 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tas_features.2  FALSE   170.    28.9   13.5     15.4     0.17  0.079<span style="text-decoration: underline;">6</span>  0.090<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> tas_features.3  FALSE    24.0    4.08   2.00     2.08    0.17  0.083<span style="text-decoration: underline;">2</span>  0.086<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> tas_features.4  FALSE    32.8    5.57   1.37     4.19    0.17  0.042<span style="text-decoration: underline;">0</span>  0.128 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> tas_features.5  FALSE    24.8    4.21   0        4.21    0.17  0       0.17  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> tas_features.6  FALSE    22.0    3.74   0        3.74    0.17  0       0.17  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> tas_features.7  FALSE    16.4    2.78   0        2.78    0.17  0       0.17  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> tas_features.8  FALSE    43.0    7.31   5.12     2.19    0.17  0.119   0.051<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> tas_features.9  FALSE   388.    66.0   22.4     43.5     0.17  0.057<span style="text-decoration: underline;">8</span>  0.112 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> tas_features.10 FALSE    14.5    2.47   0        2.47    0.17  0       0.17  </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 52 more rows, and abbreviated variable names ¹​total_amount,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​absolute_target, ³​absolute_held, ⁴​absolute_shortfall, ⁵​relative_target,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁶​relative_held, ⁷​relative_shortfall</span></span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate  feature representation statistics based on the prioritization</span></span>
<span><span class="va">tc_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_target_coverage_summary.html">eval_target_coverage_summary</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">s1</span><span class="op">[</span>, <span class="st">"solution_1"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">tc_s1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 62 × 9</span></span></span>
<span><span class="co">##    feature         met   total…¹ absol…² absol…³ absol…⁴ relat…⁵ relat…⁶ relat…⁷</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> tas_features.1  TRUE     33.9    5.77    6.97       0    0.17   0.205       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> tas_features.2  TRUE    170.    28.9    44.8        0    0.17   0.264       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> tas_features.3  TRUE     24.0    4.08    5.00       0    0.17   0.208       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> tas_features.4  TRUE     32.8    5.57   12.4        0    0.17   0.378       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> tas_features.5  TRUE     24.8    4.21    4.49       0    0.17   0.181       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> tas_features.6  TRUE     22.0    3.74    9.10       0    0.17   0.414       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> tas_features.7  TRUE     16.4    2.78    3.00       0    0.17   0.183       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> tas_features.8  TRUE     43.0    7.31    8.12       0    0.17   0.189       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> tas_features.9  TRUE    388.    66.0    76.0        0    0.17   0.196       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> tas_features.10 TRUE     14.5    2.47    3          0    0.17   0.207       0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 52 more rows, and abbreviated variable names ¹​total_amount,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​absolute_target, ³​absolute_held, ⁴​absolute_shortfall, ⁵​relative_target,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁶​relative_held, ⁷​relative_shortfall</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># explore representation by existing protected areas</span></span>
<span><span class="co">## calculate number of features adequately represented by existing protected</span></span>
<span><span class="co">## areas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tc_pa</span><span class="op">$</span><span class="va">met</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 16</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## summarize representation (values show percent coverage)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tc_pa</span><span class="op">$</span><span class="va">relative_held</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##   0.000   0.000   4.845  13.909  16.995  58.488</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## visualize representation  (values show percent coverage)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">tc_pa</span><span class="op">$</span><span class="va">relative_held</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Feature representation by existing protected areas"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Percent coverage of features (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># explore representation by prioritization</span></span>
<span><span class="co">## summarize representation (values show percent coverage)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tc_s1</span><span class="op">$</span><span class="va">relative_held</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##   17.49   19.79   25.93   34.99   44.63  100.00</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## calculate number of features adequately represented by the prioritization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tc_s1</span><span class="op">$</span><span class="va">met</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 62</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## visualize representation  (values show percent coverage)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">tc_s1</span><span class="op">$</span><span class="va">relative_held</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Feature representation by prioritization"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Percent coverage of features (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;"></p>
<p>We can see that representation of the vegetation communities by existing protected areas is remarkably poor. For example, many of the vegetation communities have nearly zero coverage by existing protected areas. In other words, are almost entirely absent from existing protected areas. We can also see that all vegetation communities have at least 17% coverage by the prioritization – meaning that it meets the representation targets for all of the features.</p>
</div>
<div class="section level2">
<h2 id="irreplaceability">Irreplaceability<a class="anchor" aria-label="anchor" href="#irreplaceability"></a>
</h2>
<p>After generating the prioritization, we can examine the relative importance of planning units selected by the prioritization. This can be useful to identify critically important planning units for conservation – in other words, places that contain biodiversity features which cannot be represented anywhere else – and schedule implementation of the prioritization. To achieve this, we will use the Ferrier metric <span class="citation">(Ferrier <em>et al.</em> 2000)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate irreplaceability</span></span>
<span><span class="va">irrep_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_ferrier_importance.html">eval_ferrier_importance</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">s1</span><span class="op">[</span><span class="st">"solution_1"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">irrep_s1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatialPolygonsDataFrame </span></span>
<span><span class="co">## features    : 1130 </span></span>
<span><span class="co">## extent      : 298809.6, 613818.8, 5167775, 5502544  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## crs         : +proj=utm +zone=55 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></span>
<span><span class="co">## variables   : 63</span></span>
<span><span class="co">## names       :      tas_features.1,      tas_features.2,      tas_features.3,      tas_features.4,      tas_features.5,    tas_features.6,      tas_features.7,      tas_features.8,     tas_features.9,     tas_features.10,   tas_features.11,     tas_features.12,     tas_features.13,    tas_features.14,     tas_features.15, ... </span></span>
<span><span class="co">## min values  :                   0,                   0,                   0,                   0,                   0,                 0,                   0,                   0,                  0,                   0,                 0,                   0,                   0,                  0,                   0, ... </span></span>
<span><span class="co">## max values  : 0.00711824775612521, 0.00677617182804085, 0.00252250621218381, 0.00603461402882859, 0.00223116059711298, 0.226881579868195, 0.00357699100195298, 0.00367543492891132, 0.0074626121416326, 0.00701739172953936, 0.230759668693182, 0.00472477144676876, 0.00256953165096351, 0.0101913850980662, 0.00618368294591574, ...</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># manually coerce values for planning units not selected in prioritization</span></span>
<span><span class="co"># to NA, so that they are shown in white</span></span>
<span><span class="va">irrep_s1</span><span class="op">$</span><span class="va">plot_total</span> <span class="op">&lt;-</span> <span class="va">irrep_s1</span><span class="op">$</span><span class="va">total</span></span>
<span><span class="va">irrep_s1</span><span class="op">$</span><span class="va">plot_total</span><span class="op">[</span><span class="va">s1</span><span class="op">$</span><span class="va">solution_1</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span>
<span></span>
<span><span class="co"># plot map of overall importance scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">irrep_s1</span><span class="op">[</span>, <span class="st">"plot_total"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Overall importance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-9-1.png" width="336" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="portfolios">Portfolios<a class="anchor" aria-label="anchor" href="#portfolios"></a>
</h2>
<p>Conservation planning exercises often involve generating multiple different prioritizations. This can help decision makers consider different options, and provide starting points for building consensus among stakeholders. To generate a range of different prioritizations given the same problem formulation, we can use portfolio functions. Here we will use the gap portfolio to generate 1000 solutions that are within 30% of optimality. Please note that you will need to have the <em>Gurobi</em> solver installed to use this specific portfolio. If you don’t have access to <em>Gurobi</em>, you could try using the shuffle portfolio instead (using the <code><a href="../reference/add_shuffle_portfolio.html">add_shuffle_portfolio()</a></code> function).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create new problem with a portfolio added to it</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="../reference/add_gap_portfolio.html">add_gap_portfolio</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">1000</span>, pool_gap <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print problem</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Conservation Problem</span></span>
<span><span class="co">##   planning units: SpatialPolygonsDataFrame (1130 units)</span></span>
<span><span class="co">##   cost:           min: 0.19249, max: 61.92727</span></span>
<span><span class="co">##   features:       tas_features.1, tas_features.2, tas_features.3, ... (62 features)</span></span>
<span><span class="co">##   objective:      Minimum set objective </span></span>
<span><span class="co">##   targets:        Relative targets [targets (min: 0.17, max: 0.17)]</span></span>
<span><span class="co">##   decisions:      Binary decision </span></span>
<span><span class="co">##   constraints:    &lt;Locked in planning units [257 locked units]&gt;</span></span>
<span><span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 0.5, max: 0.5), penalty (0.005), zones]&gt;</span></span>
<span><span class="co">##   portfolio:      Gap portfolio [number_solutions (1000), pool_gap (0.2)]</span></span>
<span><span class="co">##   solver:         default</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate prioritizations</span></span>
<span><span class="va">prt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gurobi Optimizer version 10.0.0 build v10.0.0rc2 (linux64)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]</span></span>
<span><span class="co">## Thread count: 4 physical cores, 8 logical processors, using up to 1 threads</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimize a model with 6358 rows, 4278 columns and 14496 nonzeros</span></span>
<span><span class="co">## Model fingerprint: 0x861c9b00</span></span>
<span><span class="co">## Variable types: 0 continuous, 4278 integer (4278 binary)</span></span>
<span><span class="co">## Coefficient statistics:</span></span>
<span><span class="co">##   Matrix range     [2e-06, 4e+01]</span></span>
<span><span class="co">##   Objective range  [5e-01, 2e+02]</span></span>
<span><span class="co">##   Bounds range     [1e+00, 1e+00]</span></span>
<span><span class="co">##   RHS range        [1e-01, 1e+02]</span></span>
<span><span class="co">## Found heuristic solution: objective 36805.575211</span></span>
<span><span class="co">## Found heuristic solution: objective 27817.085072</span></span>
<span><span class="co">## Presolve removed 1434 rows and 258 columns</span></span>
<span><span class="co">## Presolve time: 0.05s</span></span>
<span><span class="co">## Presolved: 4924 rows, 4020 columns, 10889 nonzeros</span></span>
<span><span class="co">## Variable types: 0 continuous, 4020 integer (4020 binary)</span></span>
<span><span class="co">## Found heuristic solution: objective 27660.082384</span></span>
<span><span class="co">## Root relaxation presolved: 4924 rows, 4020 columns, 10889 nonzeros</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Root relaxation: objective 1.954728e+04, 1905 iterations, 0.26 seconds (0.18 work units)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Nodes    |    Current Node    |     Objective Bounds      |     Work</span></span>
<span><span class="co">##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      0     0 19547.2818    0 1731 27660.0824 19547.2818  29.3%     -    0s</span></span>
<span><span class="co">## H    0     0                    26145.941445 19547.2818  25.2%     -    0s</span></span>
<span><span class="co">## H    0     0                    24520.062189 19547.2818  20.3%     -    0s</span></span>
<span><span class="co">##      0     0 19816.1878    0 1965 24520.0622 19816.1878  19.2%     -    0s</span></span>
<span><span class="co">## H    0     0                    24498.644854 19816.1878  19.1%     -    0s</span></span>
<span><span class="co">## H    0     0                    23263.485453 19816.1878  14.8%     -    0s</span></span>
<span><span class="co">## H    0     0                    21847.828075 19816.1878  9.30%     -    1s</span></span>
<span><span class="co">##      0     0 19840.6230    0 1954 21847.8281 19840.6230  9.19%     -    1s</span></span>
<span><span class="co">##      0     0 19847.1941    0 1958 21847.8281 19847.1941  9.16%     -    1s</span></span>
<span><span class="co">##      0     0 19917.2650    0 1884 21847.8281 19917.2650  8.84%     -    1s</span></span>
<span><span class="co">## H    0     0                    21831.394553 19917.2650  8.77%     -    1s</span></span>
<span><span class="co">##      0     0 19923.8717    0 1873 21831.3946 19923.8717  8.74%     -    1s</span></span>
<span><span class="co">##      0     0 19924.7815    0 1874 21831.3946 19924.7815  8.73%     -    1s</span></span>
<span><span class="co">##      0     0 19948.6397    0 1733 21831.3946 19948.6397  8.62%     -    1s</span></span>
<span><span class="co">##      0     0 19950.6344    0 1733 21831.3946 19950.6344  8.61%     -    1s</span></span>
<span><span class="co">##      0     0 19960.2198    0 1895 21831.3946 19960.2198  8.57%     -    2s</span></span>
<span><span class="co">##      0     0 19960.8567    0 1896 21831.3946 19960.8567  8.57%     -    2s</span></span>
<span><span class="co">##      0     0 19960.8917    0 1896 21831.3946 19960.8917  8.57%     -    2s</span></span>
<span><span class="co">##      0     0 19970.1883    0 1895 21831.3946 19970.1883  8.53%     -    2s</span></span>
<span><span class="co">##      0     0 19970.3008    0 1895 21831.3946 19970.3008  8.52%     -    2s</span></span>
<span><span class="co">##      0     0 19970.5283    0 1895 21831.3946 19970.5283  8.52%     -    2s</span></span>
<span><span class="co">##      0     0 19970.5509    0 1896 21831.3946 19970.5509  8.52%     -    2s</span></span>
<span><span class="co">##      0     0 19970.6229    0 1896 21831.3946 19970.6229  8.52%     -    2s</span></span>
<span><span class="co">##      0     0 19970.6229    0 1896 21831.3946 19970.6229  8.52%     -    2s</span></span>
<span><span class="co">##      0     2 19971.7903    0 1896 21831.3946 19971.7903  8.52%     -    3s</span></span>
<span><span class="co">## H   27    27                    21427.973036 19975.2817  6.78%   120    4s</span></span>
<span><span class="co">## H   54    54                    21343.168882 19975.2817  6.41%   138    5s</span></span>
<span><span class="co">## H   81    81                    21292.350054 19975.2817  6.19%   122    6s</span></span>
<span><span class="co">## H  108   108                    21239.822239 19975.2817  5.95%   101    6s</span></span>
<span><span class="co">## H  135   135                    21239.702905 19975.2817  5.95%  91.2    6s</span></span>
<span><span class="co">## H  162   162                    21232.051862 19975.2817  5.92%  83.2    7s</span></span>
<span><span class="co">## H  216   216                    21222.883764 19975.2817  5.88%  69.6    7s</span></span>
<span><span class="co">##    605     1 21222.8838  439 1731 21222.8838 19978.3972  5.86%  26.5   10s</span></span>
<span><span class="co">## H  605     1                    21195.666934 19978.3972  5.74%  26.5   10s</span></span>
<span><span class="co">## H  623    12                    21194.542724 20008.2764  5.60%  25.7   16s</span></span>
<span><span class="co">## H  631    16                    21189.637384 20011.2375  5.56%  25.4   18s</span></span>
<span><span class="co">##    636    17 21189.6374  149 1924 21189.6374 20011.9849  5.56%  25.2   20s</span></span>
<span><span class="co">##    654    10 21189.6374  545 1918 21189.6374 20015.5211  5.54%  31.5   25s</span></span>
<span><span class="co">## H  656     6                    20893.967099 20015.5293  4.20%  31.4   30s</span></span>
<span><span class="co">##    715    60 20560.8867   51 1363 20893.9671 20062.9713  3.98%  50.2   35s</span></span>
<span><span class="co">##   1359   702 20331.7094   36 1446 20893.9671 20063.1001  3.98%  39.5   40s</span></span>
<span><span class="co">##   1921  1261 20206.4844   30 1822 20893.9671 20063.6213  3.97%  38.4   45s</span></span>
<span><span class="co">## H 1975  1313                    20878.142023 20063.6213  3.90%  42.4   49s</span></span>
<span><span class="co">## H 2090  1428                    20863.500495 20063.6213  3.83%  41.8   50s</span></span>
<span><span class="co">## H 2194  1531                    20853.295502 20063.6213  3.79%  40.1   50s</span></span>
<span><span class="co">##   2595  1932 21020.0336  100   30 20853.2955 20063.6280  3.79%  39.1   55s</span></span>
<span><span class="co">## H 2647  1981                    20843.749539 20063.6280  3.74%  38.6   55s</span></span>
<span><span class="co">## H 2682  2010                    20838.509678 20063.6280  3.72%  38.2   56s</span></span>
<span><span class="co">##   3554  2843 20176.9843   27 1810 20838.5097 20070.5529  3.69%  32.1   60s</span></span>
<span><span class="co">##   3880  3035 21095.1349   77 1206 20838.5097 20085.4110  3.61%  34.1   65s</span></span>
<span><span class="co">##   4137  2937 20735.2142   51 1375 20838.5097 20086.7867  3.61%  33.8   70s</span></span>
<span><span class="co">##   4446  3030 21348.3418   73 1153 20838.5097 20087.5173  3.60%  35.2   75s</span></span>
<span><span class="co">##   4837  3275 20182.0182   28 1660 20838.5097 20090.5771  3.59%  36.3   80s</span></span>
<span><span class="co">## H 5081  3462                    20818.880749 20093.3229  3.49%  38.4   85s</span></span>
<span><span class="co">##   5412  3512 21979.6034  100  239 20818.8807 20097.6132  3.46%  39.4   90s</span></span>
<span><span class="co">##   5740  3789 21030.4728   53 1510 20818.8807 20100.1571  3.45%  40.2   95s</span></span>
<span><span class="co">##   5984  3925 20260.8315   28 1843 20818.8807 20117.0908  3.37%  41.4  100s</span></span>
<span><span class="co">##   6255  3878 20712.7473   45 1409 20818.8807 20126.0922  3.33%  42.3  106s</span></span>
<span><span class="co">## H 6256  3877                    20780.195969 20126.0922  3.15%  42.3  107s</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cutting planes:</span></span>
<span><span class="co">##   Gomory: 4</span></span>
<span><span class="co">##   Cover: 4</span></span>
<span><span class="co">##   MIR: 24</span></span>
<span><span class="co">##   StrongCG: 5</span></span>
<span><span class="co">##   Flow cover: 14</span></span>
<span><span class="co">##   GUB cover: 1</span></span>
<span><span class="co">##   Zero half: 27</span></span>
<span><span class="co">##   RLT: 17</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Explored 6302 nodes (271889 simplex iterations) in 107.99 seconds (61.30 work units)</span></span>
<span><span class="co">## Thread count was 1 (of 8 available processors)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Solution count 1000: 20780.2 20818.9 20838.5 ... 22360.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimal solution found (tolerance 1.00e-01)</span></span>
<span><span class="co">## Best objective 2.078019596858e+04, best bound 2.012609216398e+04, gap 3.1477%</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatialPolygonsDataFrame </span></span>
<span><span class="co">## features    : 1130 </span></span>
<span><span class="co">## extent      : 298809.6, 613818.8, 5167775, 5502544  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## crs         : +proj=utm +zone=55 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></span>
<span><span class="co">## variables   : 1005</span></span>
<span><span class="co">## names       :   id,              cost, status, locked_in, locked_out, solution_1, solution_2, solution_3, solution_4, solution_5, solution_6, solution_7, solution_8, solution_9, solution_10, ... </span></span>
<span><span class="co">## min values  :    1, 0.192488262910798,      0,         0,          0,          0,          0,          0,          0,          0,          0,          0,          0,          0,           0, ... </span></span>
<span><span class="co">## max values  : 1130,  61.9272727272727,      2,         1,          0,          1,          1,          1,          1,          1,          1,          1,          1,          1,           1, ...</span></span></code></pre>
<p>After generating all these prioritizations, we now want some way to visualize them. Because it would be onerous to look at each and every prioritization individually, we will use statistical analyses to help us. We can visualize the differences between these different prioritizations – based on which planning units they selected – using a hierarchical cluster analysis <span class="citation">(Harris <em>et al.</em> 2014)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract solutions</span></span>
<span><span class="va">prt_results</span> <span class="op">&lt;-</span> <span class="va">prt</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>, <span class="st">"solution_"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># calculate pair-wise distances between different prioritizations for analysis</span></span>
<span><span class="va">prt_dists</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">prt_results</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"jaccard"</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run cluster analysis</span></span>
<span><span class="va">prt_clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">prt_dists</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize clusters</span></span>
<span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4.1</span>, <span class="fl">1.5</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prt_clust</span>, labels <span class="op">=</span> <span class="cn">FALSE</span>, sub <span class="op">=</span> <span class="cn">NA</span>, xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Different prioritizations in portfolio"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can see that there are approximately six main groups of prioritizations in the portfolio. To explore these different groups, let’s conduct another cluster analysis (i.e., a <em>k</em>-medoids analysis) to extract the most representative prioritization from each of these groups. In other words, we will run another statistical analysis to find the most central prioritization within each group.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run k-medoids analysis</span></span>
<span><span class="va">prt_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></span><span class="op">(</span><span class="va">prt_dists</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract names of prioritizations that are most central for each group.</span></span>
<span><span class="va">prt_med_names</span> <span class="op">&lt;-</span> <span class="va">prt_med</span><span class="op">$</span><span class="va">medoids</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">prt_med_names</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "solution_3"   "solution_36"  "solution_446" "solution_242" "solution_421"</span></span>
<span><span class="co">## [6] "solution_502"</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a copy of prt and set values for locked in planning units to -1</span></span>
<span><span class="co"># so we can easily visualize differences between prioritizations</span></span>
<span><span class="va">prt2</span> <span class="op">&lt;-</span> <span class="va">prt</span><span class="op">[</span>, <span class="va">prt_med_names</span><span class="op">]</span></span>
<span><span class="va">prt2</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tas_pu</span><span class="op">$</span><span class="va">locked_in</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span>, <span class="va">prt_med_names</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># plot a map showing main different prioritizations</span></span>
<span><span class="co"># dark grey: locked in planning units</span></span>
<span><span class="co"># grey: planning units not selected</span></span>
<span><span class="co"># green: selected planning units</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">prt2</span><span class="op">)</span>, pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey60"</span>, <span class="st">"grey90"</span>, <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="prioritizr_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="marxan-compatibility">
<em>Marxan</em> compatibility<a class="anchor" aria-label="anchor" href="#marxan-compatibility"></a>
</h2>
<p>The <em>prioritizr R</em> package provides functionality to help <em>Marxan</em> users generate prioritizations. Specifically, it can import conservation planning data prepared for <em>Marxan</em>, and can generate prioritizations using a similar problem formulation as <em>Marxan</em> <span class="citation">(based on Beyer <em>et al.</em> 2016)</span>. Indeed, the problem formulation presented earlier in this vignette is very similar to that used by <em>Marxan</em>. The key difference is that the problem formulation we specified earlier uses “hard constraints” for feature representation, and <em>Marxan</em> uses “soft constraints” for feature representation. This means that prioritization we generated earlier was mathematically guaranteed to reach the targets for all features. However, if we used <em>Marxan</em> to generate the prioritization, then we could have produced a prioritization that would fail to reach targets (depending the <em>Species Penalty Factors</em> used to generate the prioritization). In addition to these differences in terms problem formulation, the <em>prioritizr R</em> package uses exact algorithms – instead of the simulated annealing algorithm – which ensures that we obtain prioritizations that are near optimal.</p>
<p>Here we will show the <em>prioritizr R</em> package can import <em>Marxan</em> data and generate a prioritization. To begin with, let’s import a conservation planning data prepared for <em>Marxan</em>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import data</span></span>
<span><span class="co">## planning unit data</span></span>
<span><span class="va">pu_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/pu.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span></span>
<span><span class="va">pu_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">pu_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pu_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id       cost status    xloc     yloc</span></span>
<span><span class="co">## 1  3      0.000      0 1116623 -4493479</span></span>
<span><span class="co">## 2 30   7527.275      3 1110623 -4496943</span></span>
<span><span class="co">## 3 56  37349.075      0 1092623 -4500408</span></span>
<span><span class="co">## 4 58  16959.021      0 1116623 -4500408</span></span>
<span><span class="co">## 5 84  34220.256      0 1098623 -4503872</span></span>
<span><span class="co">## 6 85 178907.584      0 1110623 -4503872</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## feature data</span></span>
<span><span class="va">spec_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/spec.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span></span>
<span><span class="va">spec_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">spec_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spec_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id prop spf   name</span></span>
<span><span class="co">## 1 10  0.3   1  bird1</span></span>
<span><span class="co">## 2 11  0.3   1  nvis2</span></span>
<span><span class="co">## 3 12  0.3   1  nvis8</span></span>
<span><span class="co">## 4 13  0.3   1  nvis9</span></span>
<span><span class="co">## 5 14  0.3   1 nvis14</span></span>
<span><span class="co">## 6 15  0.3   1 nvis20</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## amount of each feature within each planning unit data</span></span>
<span><span class="va">puvspr_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/puvspr.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span></span>
<span><span class="va">puvspr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">puvspr_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">puvspr_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   species  pu     amount</span></span>
<span><span class="co">## 1      26  56 120.344884</span></span>
<span><span class="co">## 2      26  58  45.167010</span></span>
<span><span class="co">## 3      26  84  68.047375</span></span>
<span><span class="co">## 4      26  85   9.735624</span></span>
<span><span class="co">## 5      26  86   7.803476</span></span>
<span><span class="co">## 6      26 111 478.327417</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## boundary data</span></span>
<span><span class="va">bound_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/bound.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span></span>
<span><span class="va">bound_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">bound_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bound_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id1 id2 boundary</span></span>
<span><span class="co">## 1   3   3    16000</span></span>
<span><span class="co">## 2   3  30     4000</span></span>
<span><span class="co">## 3   3  58     4000</span></span>
<span><span class="co">## 4  30  30    12000</span></span>
<span><span class="co">## 5  30  58     4000</span></span>
<span><span class="co">## 6  30  85     4000</span></span></code></pre>
<p>After importing the data, we can now generate a prioritization based on the <em>Marxan</em> problem formulation (using the <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function). <strong>Please note that this function does not generate prioritizations using <em>Marxan</em>.</strong> Instead, it uses the data to create an optimization problem formulation similar to <em>Marxan</em> – using hard constraints instead of soft constraints – and uses an exact algorithm solver to generate a prioritization.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create problem</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marxan_problem.html">marxan_problem</a></span><span class="op">(</span><span class="va">pu_data</span>, <span class="va">spec_data</span>, <span class="va">puvspr_data</span>, <span class="va">bound_data</span>,</span>
<span>                     blm <span class="op">=</span> <span class="fl">0.0005</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print problem</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Conservation Problem</span></span>
<span><span class="co">##   planning units: data.frame (1751 units)</span></span>
<span><span class="co">##   cost:           min: 0, max: 415692.19382</span></span>
<span><span class="co">##   features:       bird1, nvis2, nvis8, ... (17 features)</span></span>
<span><span class="co">##   objective:      Minimum set objective </span></span>
<span><span class="co">##   targets:        Relative targets [targets (min: 0.3, max: 0.3)]</span></span>
<span><span class="co">##   decisions:      default</span></span>
<span><span class="co">##   constraints:    &lt;Locked out planning units [1 locked units]</span></span>
<span><span class="co">##                    Locked in planning units [317 locked units]&gt;</span></span>
<span><span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 1, max: 1), penalty (5e-04), zones]&gt;</span></span>
<span><span class="co">##   portfolio:      default</span></span>
<span><span class="co">##   solver:         default</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solve problem</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gurobi Optimizer version 10.0.0 build v10.0.0rc2 (linux64)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]</span></span>
<span><span class="co">## Thread count: 4 physical cores, 8 logical processors, using up to 1 threads</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimize a model with 10075 rows, 6780 columns and 24778 nonzeros</span></span>
<span><span class="co">## Model fingerprint: 0x37d7a0a1</span></span>
<span><span class="co">## Variable types: 0 continuous, 6780 integer (6780 binary)</span></span>
<span><span class="co">## Coefficient statistics:</span></span>
<span><span class="co">##   Matrix range     [5e-05, 4e+03]</span></span>
<span><span class="co">##   Objective range  [4e+00, 4e+05]</span></span>
<span><span class="co">##   Bounds range     [1e+00, 1e+00]</span></span>
<span><span class="co">##   RHS range        [5e+03, 3e+05]</span></span>
<span><span class="co">## Found heuristic solution: objective 1.221202e+08</span></span>
<span><span class="co">## Presolve removed 4707 rows and 3103 columns</span></span>
<span><span class="co">## Presolve time: 0.14s</span></span>
<span><span class="co">## Presolved: 5368 rows, 3677 columns, 12704 nonzeros</span></span>
<span><span class="co">## Variable types: 0 continuous, 3677 integer (3677 binary)</span></span>
<span><span class="co">## Found heuristic solution: objective 1.009944e+08</span></span>
<span><span class="co">## Root relaxation presolved: 5368 rows, 3677 columns, 12704 nonzeros</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Root relaxation: objective 9.564790e+07, 521 iterations, 0.02 seconds (0.01 work units)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Nodes    |    Current Node    |     Objective Bounds      |     Work</span></span>
<span><span class="co">##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      0     0 9.5648e+07    0   20 1.0099e+08 9.5648e+07  5.29%     -    0s</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Explored 1 nodes (521 simplex iterations) in 0.19 seconds (0.10 work units)</span></span>
<span><span class="co">## Thread count was 1 (of 8 available processors)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Solution count 2: 1.00994e+08 1.2212e+08 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimal solution found (tolerance 1.00e-01)</span></span>
<span><span class="co">## Best objective 1.009944489031e+08, best bound 9.564790440581e+07, gap 5.2939%</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print first six rows of solution object</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id       cost status    xloc     yloc locked_in locked_out solution_1</span></span>
<span><span class="co">## 1  3      0.000      0 1116623 -4493479     FALSE      FALSE          0</span></span>
<span><span class="co">## 2 30   7527.275      3 1110623 -4496943     FALSE       TRUE          0</span></span>
<span><span class="co">## 3 56  37349.075      0 1092623 -4500408     FALSE      FALSE          0</span></span>
<span><span class="co">## 4 58  16959.021      0 1116623 -4500408     FALSE      FALSE          0</span></span>
<span><span class="co">## 5 84  34220.256      0 1098623 -4503872     FALSE      FALSE          0</span></span>
<span><span class="co">## 6 85 178907.584      0 1110623 -4503872     FALSE      FALSE          0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This tutorial shows how the <em>prioritizr R</em> package can be used to build a conservation problem, generate a prioritization, and evaluate it. Although we explored just a few functions, the package provides many different functions so that you can build and custom-tailor conservation planning problems to suit your needs. To learn more about the package, please see the package vignettes for <a href="package_overview.html">an overview of the package</a>, <a href="gurobi_installation_guide.html">instructions for installing the <em>Gurobi</em> optimization suite</a>, <a href="solver_benchmarks.html">benchmarks comparing the performance of different solvers</a>, and <a href="publication_record.html">a record of publications that have cited the package</a>. In addition to this tutorial, the package also provides tutorials on <a href="connectivity_tutorial.html">incorporating connectivity into prioritizations</a>, <a href="calibrating_trade-offs_tutorial.html">calibrating trade-offs between different criteria</a> (e.g., total cost and spatial fragmentation), and <a href="management_zones_tutorial.html">creating prioritizations that have multiple management zones or management actions</a>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-r3" class="csl-entry">
Ball, I.R., Possingham, H. &amp; Watts, M.E. (2009). <span class="nocase">Marxan and relatives: Software for spatial conservation prioritisation</span>. <em><span>Spatial Conservation Prioritisation: Quantitative Methods &amp; Computational Tools</span></em> (eds A. Moilanen, K.A. Wilson &amp; H. Possingham), pp. 185–189. Oxford University Press, Oxford, UK.
</div>
<div id="ref-r1" class="csl-entry">
Beyer, H.L., Dujardin, Y., Watts, M.E. &amp; Possingham, H.P. (2016). Solving conservation planning problems with integer linear programming. <em>Ecological Modelling</em>, <em>328</em>, 14–22.
</div>
<div id="ref-r34" class="csl-entry">
Ferrier, S., Pressey, R.L. &amp; Barrett, T.W. (2000). A new predictor of the irreplaceability of areas for achieving a conservation goal, its application to real-world planning, and a research agenda for further refinement. <em>Biological Conservation</em>, <em>93</em>, 303–325.
</div>
<div id="ref-r35" class="csl-entry">
Harris, L.R., Watts, M.E., Nel, R., Schoeman, D.S. &amp; Possingham, H.P. (2014). Using multivariate statistics to explore trade-offs among spatial planning scenarios (P. Armsworth, Ed.). <em>Journal of Applied Ecology</em>, <em>51</em>, 1504–1514.
</div>
<div id="ref-r30" class="csl-entry">
Klein, C., Carwardine, J., Wilson, K., Watts, M. &amp; Possingham, H. (2007). <em><span class="nocase">Spatial Prioritization Approaches for the Conservation of Biodiversity in Australia: Considering Conservation Costs, Ecological &amp; Evolutionary Processes, and Large-Intact Areas</span></em>. Report to the Department of Environment; Water Resources.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com" class="external-link">Richard Schuster</a>, Nina Morrell, <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Brandon P M Edwards, Matthew E Watts, <a href="https://arcese.forestry.ubc.ca" class="external-link">Peter Arcese</a>, <a href="https://josephrbennett.wordpress.com" class="external-link">Joseph Bennett</a>, <a href="http://www.possinghamlab.org" class="external-link">Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
