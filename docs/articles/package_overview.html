<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package overview • prioritizr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Package overview">
<meta property="og:description" content="prioritizr">
<meta property="og:image" content="https://prioritizr.net/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/package_overview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/gurobi_installation_guide.html">Gurobi installation guide</a>
    </li>
    <li>
      <a href="../articles/solver_benchmarks.html">Solver benchmarks</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication record</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/connectivity_tutorial.html">Connectivity</a>
    </li>
    <li>
      <a href="../articles/calibrating_trade-offs_tutorial.html">Calibrating trade-offs</a>
    </li>
    <li>
      <a href="../articles/management_zones_tutorial.html">Management zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prioritizr/prioritizr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Package overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prioritizr/prioritizr/blob/HEAD/vignettes/package_overview.Rmd" class="external-link"><code>vignettes/package_overview.Rmd</code></a></small>
      <div class="hidden name"><code>package_overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The <em>prioritizr R</em> package uses integer linear programming (ILP) techniques to provide a flexible interface for building and solving conservation planning problems <span class="citation">(Rodrigues <em>et al.</em> 2000; Billionnet 2013)</span>. It supports a broad range of objectives, constraints, and penalties that can be used to custom-tailor conservation planning problems to the specific needs of a conservation planning exercise. Once built, conservation planning problems can be solved using a variety of commercial and open-source exact algorithm solvers. In contrast to the algorithms conventionally used to solve conservation problems, such as heuristics or simulated annealing <span class="citation">(Ball <em>et al.</em> 2009)</span>, the exact algorithms used here are guaranteed to find optimal solutions. Furthermore, conservation problems can be constructed to optimize the spatial allocation of different management zone (or actions), meaning that conservation practitioners can identify solutions that benefit multiple stakeholders. Finally, this package has the functionality to read input data formatted for the <em>Marxan</em> conservation planning program <span class="citation">(Ball <em>et al.</em> 2009)</span>, and find much cheaper solutions in a much shorter period of time than <em>Marxan</em> <span class="citation">(Beyer <em>et al.</em> 2016)</span>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Systematic conservation planning is a rigorous, repeatable, and structured approach to designing new protected areas that efficiently meet conservation objectives <span class="citation">(Margules &amp; Pressey 2000)</span>. Historically, conservation decision-making has often evaluated parcels opportunistically as they became available for purchase, donation, or under threat. Although purchasing such areas may improve the <em>status quo</em>, such decisions may not substantially enhance the long-term persistence of target species or communities. Faced with this realization, conservation planners began using decision support tools to help simulate alternative reserve designs over a range of different biodiversity and management goals and, ultimately, guide protected area acquisitions and management actions. Due to the systematic, evidence-based nature of these tools, conservation prioritization can help contribute to a transparent, inclusive, and more defensible decision making process.</p>
<p>A conservation planning exercise typically starts by defining a study area. This study area should encompass all the areas relevant to the decision maker or the hypothesis being tested. The extent of a study area could encompass a few important localities <span class="citation">(e.g., Stigner <em>et al.</em> 2016)</span>, a single state <span class="citation">(e.g., Kirkpatrick 1983)</span>, an entire country <span class="citation">(Fuller <em>et al.</em> 2010)</span>, or the entire planet <span class="citation">(Butchart <em>et al.</em> 2015)</span>. Next, the study area is divided into a set of discrete areas termed <em>planning units</em>. Each planning unit represents a discrete locality in the study area that can be managed independently of other areas. The general idea is that some combination of the planning units can be selected for conservation actions (e.g., protected area establishment, habitat restoration). Planning units are often created as square or hexagon cells that are sized according to the scale of the conservation actions, and the resolution of the data that underpin the planning exercise <span class="citation">(but see Klein <em>et al.</em> 2009)</span>.</p>
<p>Cost data (or a surrogate thereof) are needed to inform the prioritization process. Specifically, these cost data describe the relative expenditure associated with managing each planning unit for conservation. For example, if the goal of the conservation planning exercise is to identify priority areas for expanding a local protected area system, then the cost data could represent the physical cost of purchasing the land. Alternatively, if such data are not available, then surrogate data could are often used instead (e.g., human population density, opportunity cost of foregone commercial activities, or planning unit size).</p>
<p>Conservation planning exercises also require data on the biodiversity elements that are of conservation interest (termed <em>conservation features</em>). These features could be species (e.g., <em>Neofelis nebulosa</em>, the Clouded Leopard), populations, or habitats (e.g., mangroves or cloud forest). After identifying the set of relevant conservation features for a conservation planning exercise, spatially explicit data need to be obtained for each and every feature to describe their spatial distribution (e.g., habitat suitability data, probability of occurrence data, presence/absence data). This is important to ensure that conservation features are adequately covered (represented) by prioritizations. After assembling all the data, the next step is to define the conservation planning problem.</p>
<p>The <em>prioritizr R</em> package is designed to help you build and solve conservation planning problems. Specifically, prioritizations are generated by using formulating a mathematical optimization problem and then solving it to generate a solution. These mathematical optimization problems are formulated using the planning unit data, cost data, and feature data, and with information related to the overarching aim of the prioritization process. In general, the goal of an optimization problem is to minimize (or maximize) an <em>objective function</em> that is calculated using a set of <em>decision variables</em>, subject to a series of constraints to ensure that solution exhibits specific properties. The objective function describes the quantity which we are trying to minimize (e.g., cost of the solution) or maximize (e.g., number of features conserved). The decision variables describe the entities that we can control, and indicate which planning units are selected for conservation management and which of those are not. The constraints can be thought of as rules that the need decision variables need to follow. For example, a commonly used constraint is specifying that the solution must not exceed a certain budget.</p>
<p>A wide variety of approaches have been developed for solving optimization problems. Reserve design problems are frequently solved using simulated annealing <span class="citation">(Kirkpatrick <em>et al.</em> 1983)</span> or heuristics <span class="citation">(Nicholls &amp; Margules 1993; Moilanen 2007)</span>. These methods are conceptually simple and can be applied to a wide variety of optimization problems. However, they do not scale well for large or complex problems <span class="citation">(Beyer <em>et al.</em> 2016)</span>. Additionally, these methods cannot tell you how close any given solution is to the optimal solution. The package uses exact algorithms to efficiently solve conservation planning problems to within a pre-specified a optimality gap. In other words, you can specify that you need the optimal solution (i.e., a gap of 0%) and the algorithms will, given enough time, find a solution that meets this criteria. In the past, exact algorithms have been too slow for conservation planning exercises <span class="citation">(Pressey <em>et al.</em> 1996)</span>. However, improvements over the last decade mean that they are now much faster <span class="citation">(Achterberg &amp; Wunderling 2013; Beyer <em>et al.</em> 2016)</span>.</p>
<p>In this package, optimization problems are expressed using <em>integer linear programming</em> (ILP) so that they can be solved using (linear) exact algorithm solvers. The general form of an integer programming problem can be expressed in matrix notation using the following equation.</p>
<p><span class="math display">\[\text{Minimize} \space \boldsymbol{c}^\text{T} \boldsymbol{x} \space
\space \text{subject to} \space A\boldsymbol{x}
\space \Box \space \boldsymbol{b}\]</span></p>
<p>Here, where <span class="math inline">\(x\)</span> is a vector of decision variables, <span class="math inline">\(c\)</span> and <span class="math inline">\(b\)</span> are vectors of known coefficients, and <span class="math inline">\(A\)</span> is the constraint matrix. The final term specifies a series of structural constants and the <span class="math inline">\(\Box\)</span> symbol is used to indicate that the relational operators for the constraints can be either <span class="math inline">\(\geq\)</span>, <span class="math inline">\(=\)</span>, or <span class="math inline">\(\leq\)</span>. In the context of a conservation planning problem, <span class="math inline">\(c\)</span> could be used to represent the planning unit costs, <span class="math inline">\(A\)</span> could be used to store the data showing the presence / absence (or amount) of each feature in each planning unit, <span class="math inline">\(b\)</span> could be used to represent minimum amount of habitat required for each species in the solution, the <span class="math inline">\(\Box\)</span> could be set to <span class="math inline">\(\geq\)</span> symbols to indicate that the total amount of each feature in the solution must exceed the quantities in <span class="math inline">\(b\)</span>. But there are many other ways of formulating the reserve selection problem <span class="citation">(Rodrigues <em>et al.</em> 2000)</span>.</p>
</div>
<div class="section level2">
<h2 id="a-grammar-for-conservation-planning">A grammar for conservation planning<a class="anchor" aria-label="anchor" href="#a-grammar-for-conservation-planning"></a>
</h2>
<p>The <em>prioritizr R</em> package uses a grammar to describe elements of conservation planning. This means that functions are organized into verbs that relate to specific concepts. For example, all of the functions used to specify the primary objective for optimization end with the <code>_objective</code> suffix (e.g., <code><a href="../reference/add_min_set_objective.html">add_min_set_objective()</a></code> and <code><a href="../reference/add_min_shortfall_objective.html">add_min_shortfall_objective()</a></code>). By combining multiple functions together, they can be used to formulate a complete conservation planning problem. Specifically, the verbs for formulating problems are described below.</p>
<ul>
<li>Create a new conservation planning <a href="https://prioritizr.net/reference/problem.html">problem</a> by specifying the planning units, features, and management zones of conservation interest.</li>
<li>Add a primary <a href="https://prioritizr.net/reference/objectives.html">objective</a> to a conservation planning problem (e.g., minimize overall cost).</li>
<li>Add <a href="https://prioritizr.net/reference/penalties.html">penalties</a> to a conservation planning problem to penalize solutions according to specific metric (e.g., connectivity).</li>
<li>Add <a href="https://prioritizr.net/reference/targets.html">targets</a> to a conservation planning problem to specify how much of each feature should ideally be represented solutions.</li>
<li>Add <a href="https://prioritizr.net/reference/constraints.html">constraints</a> to a conservation planning problem to ensure that solutions exhibit specific properties (e.g., select specific planning units for protection).</li>
<li>Add <a href="https://prioritizr.net/reference/decisions.html">decisions</a> to a conservation planning problem to specify the nature of the decisions in the problem (e.g., binary decisions indicate the planning units should be selected or not selected for management).</li>
<li>Add a <a href="https://prioritizr.net/reference/portfolios.html">portfolio</a> to a conservation planning problem to specify a methodological approach for generating multiple solutions (e.g. generate multiple solutions by finding 100 solutions within 10% of optimality).</li>
<li>Add a <a href="https://prioritizr.net/reference/solvers.html">solver</a> to a conservation problem to specify the optimization software (e.g. Gurobi) for generating solutions and customize the optimization settings (e.g. generate an optimal solution).</li>
</ul>
<p>After building a conservation planning problem, it can be solved to generate a prioritization (using the <code><a href="../reference/solve.html">solve()</a></code> function). There are also verbs available to help evaluate and interpret solutions. These verbs are described below.</p>
<ul>
<li>Evaluate performance by computing <a href="https://prioritizr.net/reference/summaries.html">summary statistics</a> (e.g. overall cost, feature representation, or total boundary length).</li>
<li>Evaluate the relative <a href="https://prioritizr.net/reference/importance.html">importance</a> of planning units selected by a solution (e.g. based on irreplaceability).</li>
</ul>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The general workflow when using the <em>prioritizr R</em> package starts with creating a new conservation planning <code><a href="../reference/problem.html">problem()</a></code> object using data. Specifically, the <code><a href="../reference/problem.html">problem()</a></code> object should be constructed using data that specify the planning units, biodiversity features, management zones (if applicable), and costs. After creating a new <code><a href="../reference/problem.html">problem()</a></code> object, it can be customized—by adding objectives, penalties, constraints, and other information—to build a precise representation of the conservation planning problem required, and then solved to obtain a solutions.</p>
<p>All conservation planning problems require an objective. An objective specifies the property which is used to compare different feasible solutions. Simply put, the objective is the property of the solution which should be maximized or minimized during the optimization process. For instance, with the minimum set objective (specified using <code><a href="../reference/add_min_set_objective.html">add_min_set_objective()</a></code>), we are seeking to minimize the cost of the solution (similar to <em>Marxan</em>). On the other hand, with the minimum shortfall objective (specified using <code><a href="../reference/add_min_shortfall_objective.html">add_min_shortfall_objective()</a></code>), we are seeking to minimize the average target shortfall for all features represented in the solution, subject to a budget.</p>
<p>Many objectives require representation targets (e.g., the minimum set objective). These targets are a specialized set of constraints that relate to the total quantity of each feature secured in the solution (e.g., amount of suitable habitat or number of individuals). In the case of the minimum set objective ( <code><a href="../reference/add_min_set_objective.html">add_min_set_objective()</a></code>), they are used to ensure that solutions secure a sufficient quantity of each feature, and in other objectives, such as the maximum features objective ( <code><a href="../reference/add_max_features_objective.html">add_max_features_objective()</a></code>) they are used to assess whether a feature has been adequately conserved by a candidate solution. Targets can be expressed numerically as the total amount required for a given feature (using <code><a href="../reference/add_absolute_targets.html">add_absolute_targets()</a></code>), or as a proportion of the total amount found in the planning units (using <code><a href="../reference/add_relative_targets.html">add_relative_targets()</a></code>). Note that not all objectives require targets, and a warning will be thrown if an attempt is made to add targets to a problem with an objective that does not use them.</p>
<p>Constraints and penalties can be added to a conservation planning problem to ensure that solutions exhibit a specific property or penalize solutions which don’t exhibit a specific property (respectively). The difference between constraints and penalties, strictly speaking, is constraints are used to rule out potential solutions that don’t exhibit a specific property. For instance, constraints can be used to ensure that specific planning units are selected in the solution for prioritization (using <code><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints()</a></code>) or not selected in the solution for prioritization (using <code><a href="../reference/add_locked_out_constraints.html">add_locked_out_constraints()</a></code>). On the other hand, penalties are combined with the objective of a problem, with a penalty factor, and the overall objective of the problem then becomes to minimize (or maximize) the primary objective function and the penalty function. For example, penalties can be added to a problem to penalize solutions that are excessively fragmented (using <code><a href="../reference/add_boundary_penalties.html">add_boundary_penalties()</a></code>). These penalties have a <code>penalty</code> argument that specifies the relative importance of having spatially clustered solutions. When the argument to <code>penalty</code> is high, then solutions which are less fragmented are valued more highly – even if they cost more – and when the argument to <code>penalty</code> is low, then the solutions which are more fragmented are valued less highly.</p>
<p>After building a conservation problem, it can then be solved to obtain a solution (or portfolio of solutions if desired). The solution is returned in the same format as the planning unit data used to construct the problem. For instance, this means that if raster data was used to initialize the problem, then the solution will also be output in raster format. This can be very helpful when it comes to interpreting and visualizing solutions because it means that the solution data does not first have to be merged with spatial data before they can be plotted on a map.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Here we will provide an introduction to using the <em>prioritizr R</em> package to build and solve a conservation planning problem. Please note that we will not discuss conservation planning with multiple zones in this vignette, for more information on working with multiple management zones please see the <a href="zones.html">zones vignette</a>.</p>
<p>First, we will load the <em>prioritizr</em> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.net">prioritizr</a></span><span class="op">)</span>

<span class="co"># set default options for printing tabular data</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tibble.width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>Now we will load some built-in data sets that are distributed with the <em>prioritizr R</em> package. This package contains several different planning unit data sets. To provide a comprehensive overview of the different ways that we can initialize a conservation planning problem, we will load each of them.</p>
<p>First, we will load the raster planning unit data (<code>sim_pu_raster</code>). Here, the planning units are represented as a raster (i.e., a <code>RasterLayer</code> object) and each pixel corresponds to the spatial extent of each panning unit. The pixel values correspond to the acquisition costs of each planning unit.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load raster planning unit data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_pu_raster</span><span class="op">)</span>

<span class="co"># print description of the data</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">sim_pu_raster</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## class      : RasterLayer </span>
<span class="co">## dimensions : 10, 10, 100  (nrow, ncol, ncell)</span>
<span class="co">## resolution : 0.1, 0.1  (x, y)</span>
<span class="co">## extent     : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)</span>
<span class="co">## crs        : NA </span>
<span class="co">## source     : memory</span>
<span class="co">## names      : layer </span>
<span class="co">## values     : 190.1328, 215.8638  (min, max)</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot the data</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_pu_raster</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Secondly, we will load one of the spatial vector planning unit data sets (<code>sim_pu_polygons</code>). Here, each polygon (i.e., feature using ArcGIS terminology) corresponds to a different planning unit. This data set has an attribute table that contains additional information about each polygon. Namely, the <code>cost</code> field (column) in the attribute table contains the acquisition cost for each planning unit.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load polygon planning unit data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span><span class="op">)</span>

<span class="co"># print first six rows of attribute table</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       cost locked_in locked_out</span>
<span class="co">## 1 215.8638     FALSE      FALSE</span>
<span class="co">## 2 212.7823     FALSE      FALSE</span>
<span class="co">## 3 207.4962     FALSE      FALSE</span>
<span class="co">## 4 208.9322     FALSE       TRUE</span>
<span class="co">## 5 214.0419     FALSE      FALSE</span>
<span class="co">## 6 213.7636     FALSE      FALSE</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot the planning units</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, zcol <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Thirdly, we will load some planning unit data stored in tabular format (i.e., <code>data.frame</code> format). For those familiar with <em>Marxan</em> or dealing with very large conservation planning problems (&gt; 10 million planning units), it may be useful to work with data in this format because it does not contain any spatial information which will reduce computational burden. When using tabular data to initialize conservation planning problems, the data must follow the conventions used by <em>Marxan</em>. Specifically, each row in the planning unit table must correspond to a different planning unit. The table must also have an “id” column to provide a unique integer identifier for each planning unit, and it must also have a column that indicates the cost of each planning unit. For more information, please see the <a href="https://marxansolutions.org/" class="external-link">official <em>Marxan</em> documentation</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specify file path for planning unit data</span>
<span class="va">pu_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/pu.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span>

<span class="co"># load in the tabular planning unit data</span>
<span class="co"># note that we use the data.table::fread function, as opposed to the read.csv</span>
<span class="co"># function, because it is much faster</span>
<span class="va">pu_dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">pu_path</span>, data.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># preview first six rows of the tabular planning unit data</span>
<span class="co"># note that it has some extra columns other than id and cost as per the</span>
<span class="co"># Marxan format</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pu_dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   id       cost status    xloc     yloc</span>
<span class="co">## 1  3        0.0      0 1116623 -4493479</span>
<span class="co">## 2 30   752727.5      3 1110623 -4496943</span>
<span class="co">## 3 56  3734907.5      0 1092623 -4500408</span>
<span class="co">## 4 58  1695902.1      0 1116623 -4500408</span>
<span class="co">## 5 84  3422025.6      0 1098623 -4503872</span>
<span class="co">## 6 85 17890758.4      0 1110623 -4503872</span></code></pre>
<p>Finally, we will load data showing the spatial distribution of the conservation features. Our conservation features (<code>sim_features</code>) are represented as a stack of raster objects (i.e., a <code>RasterStack</code> object) where each layer corresponds to a different feature (e.g., a multi-band GeoTIFF where each band corresponds to a different feature). The pixel values in each layer correspond to the amount of suitable habitat available in a given planning unit. Note that our planning unit raster layer and our conservation feature stack have exactly the same spatial properties (i.e., resolution, extent, coordinate reference system) so their pixels line up perfectly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load feature data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_features</span><span class="op">)</span>

<span class="co"># plot the distribution of suitable habitat for each feature</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_features</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Feature"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">sim_features</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
     nr <span class="op">=</span> <span class="fl">2</span>, box <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="initialize-a-problem">Initialize a problem<a class="anchor" aria-label="anchor" href="#initialize-a-problem"></a>
</h3>
<p>After having loaded our planning unit and feature data, we will now try initializing the some conservation planning problems. There are a lot of different ways to initialize a conservation planning problem, so here we will just showcase a few of the more commonly used methods. For an exhaustive description of all the ways you can initialize a conservation problem, see the help file for the <code><a href="../reference/problem.html">problem()</a></code> function. First off, we will initialize a conservation planning problem using the raster data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      none</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print number of planning units</span>
<span class="fu"><a href="../reference/number_of_planning_units.html">number_of_planning_units</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 90</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print number of features</span>
<span class="fu"><a href="../reference/number_of_features.html">number_of_features</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 5</span></code></pre>
<p>Generally, we recommend initializing problems using raster data where possible. This is because the <code><a href="../reference/problem.html">problem()</a></code> function needs to calculate the amount of each feature in each planning unit, and by providing both the planning unit and feature data in raster format with the same spatial resolution, extents, and coordinate systems, this means that the <code><a href="../reference/problem.html">problem()</a></code> function does not need to do any geoprocessing behind the scenes. But sometimes we can’t use raster planning unit data because our planning units aren’t equal-sized grid cells. So, below is an example showing how we can initialize a conservation planning problem using planning units that are formatted as spatial vector data. Note that if we had precomputed the amount of each feature in each planning unit and stored the data in the attribute table, we could pass in the names of the columns as an argument to the <code><a href="../reference/problem.html">problem()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with spatial vector data</span>
<span class="co"># note that we have to specify which column in the attribute table contains</span>
<span class="co"># the cost data</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, <span class="va">sim_features</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: SpatialPolygonsDataFrame (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      none</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<p>We can also initialize a conservation planning problem using tabular planning unit data (i.e., <code>data.frame</code> format). Since the tabular planning unit data does not contain any spatial information, we also have to provide the feature data in tabular format (i.e., <code>data.frame</code> format) and data showing the amount of each feature in each planning unit in tabular format (i.e., <code>data.frame</code> format). The feature data must have an “id” column containing a unique integer identifier for each feature, and the planning unit by feature data must contain the following three columns: <code>pu</code> corresponding to the planning unit identifiers, <code>species</code> corresponding to the feature identifiers, and <code>amount</code> showing the amount of a given feature in a given planning unit.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set file path for feature data</span>
<span class="va">spec_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/spec.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span>

<span class="co"># load in feature data</span>
<span class="va">spec_dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">spec_path</span>, data.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># print first six rows of the data</span>
<span class="co"># note that it contains extra columns</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spec_dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   id prop spf   name</span>
<span class="co">## 1 10  0.3   1  bird1</span>
<span class="co">## 2 11  0.3   1  nvis2</span>
<span class="co">## 3 12  0.3   1  nvis8</span>
<span class="co">## 4 13  0.3   1  nvis9</span>
<span class="co">## 5 14  0.3   1 nvis14</span>
<span class="co">## 6 15  0.3   1 nvis20</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set file path for planning unit vs. feature data</span>
<span class="va">puvspr_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/puvspr.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span>

<span class="co"># load in planning unit vs feature data</span>
<span class="va">puvspr_dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">puvspr_path</span>, data.table <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># print first six rows of the data</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">puvspr_dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   species  pu     amount</span>
<span class="co">## 1      26  56 1203448.84</span>
<span class="co">## 2      26  58  451670.10</span>
<span class="co">## 3      26  84  680473.75</span>
<span class="co">## 4      26  85   97356.24</span>
<span class="co">## 5      26  86   78034.76</span>
<span class="co">## 6      26 111 4783274.17</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">pu_dat</span>, <span class="va">spec_dat</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span>, rij <span class="op">=</span> <span class="va">puvspr_dat</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: data.frame (1751 units)</span>
<span class="co">##   cost:           min: 0, max: 41569219.38232</span>
<span class="co">##   features:       bird1, nvis2, nvis8, ... (17 features)</span>
<span class="co">##   objective:      none</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<p>For more information on initializing problems, please see the help page for the <code><a href="../reference/problem.html">problem()</a></code> function (which you can open by entering the code: <code><a href="../reference/problem.html">?problem</a></code>). Now that we have initialized a conservation planning problem, we will show you how you can customize it to suit the exact needs of your conservation planning scenario. Although we initialized the conservation planning problems using several different methods, moving forward, we will only use raster-based planning unit data to keep things simple.</p>
</div>
<div class="section level3">
<h3 id="add-an-objective">Add an objective<a class="anchor" aria-label="anchor" href="#add-an-objective"></a>
</h3>
<p>The next step is to add a primary objective to the problem. A problem objective is used to specify the primary goal of the problem (i.e., the quantity that is to be maximized or minimized). All conservation planning problems involve minimizing or maximizing some kind of objective. For instance, we might require a solution that conserves enough habitat for each species while minimizing the overall cost of the reserve network. Alternatively, we might require a solution that maximizes the number of conserved species while ensuring that the cost of the reserve network does not exceed the budget. Please note that objectives are added in the same way regardless of the type of data used to initialize the problem. The following objectives are available.</p>
<ul>
<li>
<strong>Minimum set objective</strong>: Minimize the cost of the solution whilst ensuring that all targets are met <span class="citation">(Rodrigues <em>et al.</em> 2000)</span>. This objective is similar to that used in <em>Marxan</em> <span class="citation">(Ball <em>et al.</em> 2009)</span>. For example, we can add a minimum set objective to a problem using the following code.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the minimum set objective</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Maximum cover objective</strong>: Represent at least one instance of as many features as possible within a given budget <span class="citation">(Church <em>et al.</em> 1996)</span>.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the maximum coverage objective and a budget</span>
<span class="co"># of 5000</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_max_cover_objective.html">add_max_cover_objective</a></span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Maximum coverage objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Maximum features objective</strong>: Fulfill as many targets as possible while ensuring that the cost of the solution does not exceed a budget <span class="citation">(inspired by Cabeza &amp; Moilanen 2001)</span>. This object is similar to the maximum cover objective except that we have the option of later specifying targets for each feature. In practice, this objective is more useful than the maximum cover objective because features often require a certain amount of area for them to persist and simply capturing a single instance of habitat for each feature is generally unlikely to enhance their long-term persistence.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the maximum features objective and a budget</span>
<span class="co"># of 5000</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_max_features_objective.html">add_max_features_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Maximum representation objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Minimum shortfall objective</strong>: Minimize the overall (weighted sum) shortfall for as many targets as possible while ensuring that the cost of the solution does not exceed a budget. In practice, this objective useful when there is a large amount of left-over budget when using the maximum feature representation objective and the remaining funds need to be allocated to places that will enhance the representation of features with unmet targets.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the minimum shortfall objective and a budget</span>
<span class="co"># of 5000</span>
<span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_min_shortfall_objective.html">add_min_shortfall_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p6</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum shortfall objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Minimum largest shortfall objective</strong>: Minimize the largest (maximum) shortfall while ensuring that the cost of the solution does not exceed a budget. In practice, this objective useful when the minimum shortfall objective returns solutions that focus too much on representing a small number of features (e.g., because they occur in much cheaper planning units), and solutions are needed to spread conservation effort out more evenly among all features—even if it means that all features will have (relatively) poor representation.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the minimum largest shortfall objective and a</span>
<span class="co"># budget of 5000</span>
<span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_min_largest_shortfall_objective.html">add_min_largest_shortfall_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p7</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum largest shortfall objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Maximum phylogenetic diversity objective</strong>: Maximize the phylogenetic diversity of the features represented in the solution subject to a budget <span class="citation">(inspired by Faith 1992; Rodrigues &amp; Gaston 2002)</span>. This objective is similar to the maximum features objective except that emphasis is placed on protecting features which are associated with a diverse range of evolutionary histories. The package contains a simulated phylogeny that can be used with the simulated feature data (<code>sim_phylogny</code>).</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load simulated phylogeny data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_phylogeny</span><span class="op">)</span>

<span class="co"># create a new problem that has the maximum phylogenetic diversity</span>
<span class="co"># objective and a budget of 5000</span>
<span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_max_phylo_div_objective.html">add_max_phylo_div_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span>, tree <span class="op">=</span> <span class="va">sim_phylogeny</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required namespace: ape</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p8</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Phylogenetic diversity objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Maximum phylogenetic endemism objective</strong>: Maximize the phylogenetic endemism of the features represented in the solution subject to a budget <span class="citation">(inspired by Faith 1992; Rodrigues &amp; Gaston 2002; Rosauer <em>et al.</em> 2009)</span>. This objective is similar to the maximum phylogenetic diversity except that emphasis is placed conserving features that are associated with geographically restricted periods of evolutionary history rather than a diverse range of evolutionary histories.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load simulated phylogeny data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_phylogeny</span><span class="op">)</span>

<span class="co"># create a new problem that has the maximum phylogenetic diversity</span>
<span class="co"># objective and a budget of 5000</span>
<span class="va">p9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_max_phylo_end_objective.html">add_max_phylo_end_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span>, tree <span class="op">=</span> <span class="va">sim_phylogeny</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p9</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Phylogenetic endemism objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Maximum utility objective</strong>: Secure as much of the features as possible without exceeding a budget. This objective is functionally equivalent to selecting the planning units with the greatest amounts of each feature (e.g., species richness). Generally, we don’t encourage the use of this objective because it will only rarely identify complementary solutions–solutions which adequately conserve a range of different features—except perhaps to explore trade-offs or provide a baseline solution with which to compare other solutions.</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a new problem that has the maximum utility objective and a budget</span>
<span class="co"># of 5000</span>
<span class="va">p10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="../reference/add_max_utility_objective.html">add_max_utility_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># print the problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p10</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Maximum utility objective [budget (5000)]</span>
<span class="co">##   targets:        none</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
</div>
<div class="section level3">
<h3 id="add-targets">Add targets<a class="anchor" aria-label="anchor" href="#add-targets"></a>
</h3>
<p>Most conservation planning problems require targets. Targets are used to specify the minimum amount or proportion of a feature’s distribution that needs to be protected in the solution. For example, we may want to develop a reserve network that will secure 20% of the distribution for each feature for minimal cost. The following methods are available for specifying targets.</p>
<ul>
<li>
<strong>Absolute targets</strong>: Targets are expressed as the total amount of each feature in the study area that need to be secured. For example, if we had binary feature data that showed the absence or presence of suitable habitat across the study area, we could set an absolute target as 5 to mean that we require 5 planning units with suitable habitat in the solution.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem with targets which specify that the solution must conserve</span>
<span class="co"># a need a sum total of 3 units of suitable habitat for each feature</span>
<span class="va">p11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_absolute_targets.html">add_absolute_targets</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p11</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Absolute targets [targets (min: 3, max: 3)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Relative targets</strong>: Targets are set as a proportion (between 0 and 1) of the total amount of each feature in the study area. For example, if we had binary feature data and the feature occupied a total of 20 planning units in the study area, we could set a relative target of 50 % to specify that the solution must secure 10 planning units for the feature. We could alternatively specify an absolute target of 10 to achieve the same result, but sometimes proportions are easier to work with.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem with the minimum set objective and relative targets of 10 %</span>
<span class="co"># for each feature</span>
<span class="va">p12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p12</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem with targets which specify that we need 10 % of the habitat</span>
<span class="co"># for the first feature, 15 % for the second feature, 20 % for the third feature</span>
<span class="co"># 25 % for the fourth feature and 30 % of the habitat for the fifth feature</span>
<span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span><span class="op">)</span>
<span class="va">p13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="va">targets</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p13</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.3)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Log-linear targets</strong>: Targets are expressed using scaling factors and log-linear interpolation. This method for specifying targets is commonly used for global prioritization analyses <span class="citation">(Rodrigues <em>et al.</em> 2004)</span>.</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with added log-linear targets</span>
<span class="va">p14</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_loglinear_targets.html">add_loglinear_targets</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0.9</span>, <span class="fl">100</span>, <span class="fl">0.2</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p14</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Absolute targets [targets (min: 17.290505409161, max: 21.5906174426385)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Manual targets</strong>: Targets are manually specified. This is only really recommended for advanced users or problems that involve multiple management zones. See the <a href="zones.html">zones vignette</a> for more information on these targets.</li>
</ul>
<p>As with the functions for specifying the objective of a problem, if we try adding multiple targets to a problem, only the most recently added set of targets are used.</p>
</div>
<div class="section level3">
<h3 id="add-constraints">Add constraints<a class="anchor" aria-label="anchor" href="#add-constraints"></a>
</h3>
<p>A constraint can be added to a conservation planning problem to ensure that all solutions exhibit a specific property. For example, they can be used to make sure that all solutions select a specific planning unit or that all selected planning units in the solution follow a certain configuration. The following constraints are available.</p>
<ul>
<li>
<strong>Locked in constraints</strong>: Add constraints to ensure that certain planning units are prioritized in the solution. For example, it may be desirable to lock in planning units that are inside existing protected areas so that the solution fills in the gaps in the existing reserve network.</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that the first planning unit</span>
<span class="co"># must be selected in the solution</span>
<span class="va">p15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p15</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked in planning units [1 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Locked out constraints</strong>: Add constraints to ensure that certain planning units are not prioritized in the solution. For example, it may be useful to lock out planning units that have been degraded and are not suitable for conserving species.</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that the second planning unit</span>
<span class="co"># must not be selected in the solution</span>
<span class="va">p16</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_out_constraints.html">add_locked_out_constraints</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p16</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked out planning units [1 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Neighbor constraints</strong>: Add constraints to a conservation problem to ensure that all selected planning units have at least a certain number of neighbors.</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that all selected planning units</span>
<span class="co"># in the solution must have at least 1 neighbor</span>
<span class="va">p17</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_neighbor_constraints.html">add_neighbor_constraints</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p17</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Neighbor constraint [number of neighbors (1), zones]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Contiguity constraints</strong>: Add constraints to a conservation problem to ensure that all selected planning units are spatially connected to each other and form spatially contiguous unit.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that all selected planning units</span>
<span class="co"># in the solution must form a single contiguous unit</span>
<span class="va">p18</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_contiguity_constraints.html">add_contiguity_constraints</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p18</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Contiguity constraints [apply constraints? (1), zones]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Feature contiguity constraints</strong>: Add constraints to ensure that each feature is represented in a contiguous unit of dispersible habitat. These constraints are a more advanced version of those implemented in the <code>add_contiguity_constraints</code> function, because they ensure that each feature is represented in a contiguous unit and not that the entire solution should form a contiguous unit.</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that the planning units used</span>
<span class="co"># to conserve each feature must form a contiguous unit</span>
<span class="va">p19</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_feature_contiguity_constraints.html">add_feature_contiguity_constraints</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p19</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Feature contiguity constraints [apply constraints? (1), layer.1 zones, layer.2 zones, layer.3 zones, layer.4 zones, layer.5 zones]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Linear constraints</strong>: Add constraints to ensure that all selected planning units meet certain criteria. For example, they can be used to add multiple budgets, or limit the number of planning units selected in different administrative areas within a study region (e.g., different countries).</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with constraints which specify that the sum of</span>
<span class="co"># values in sim_features[[1]] among selected planning units must not exceed a</span>
<span class="co">#' threshold value of 190.</span>
<span class="va">p20</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_shortfall_objective.html">add_min_shortfall_objective</a></span><span class="op">(</span>budget <span class="op">=</span> <span class="fl">1800</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_linear_constraints.html">add_linear_constraints</a></span><span class="op">(</span><span class="fl">190</span>, <span class="st">"&lt;="</span>, <span class="va">sim_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p20</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum shortfall objective [budget (1800)]</span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Linear constraints [threshold (190)]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Mandatory allocation constraints</strong>: Add constraints to ensure that every planning unit is allocated to a management zone in the solution. Please note that this function can only be used with problems that contain multiple zones. For more information on problems with multiple zones and an example using this function, see the Management Zones vignette.</li>
</ul>
<p>In particular, The <code>add_locked_in_constraints</code> and <code>add_locked_out_constraints</code> functions are incredibly useful for real-world conservation planning exercises, so it’s worth pointing out that there are several ways we can specify which planning units should be locked in or out of the solutions. If we use raster planning unit data, we can also use raster data to specify which planning units should be locked in our locked out.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load data to lock in or lock out planning units</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_locked_in_raster</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_locked_out_raster</span><span class="op">)</span>

<span class="co"># plot the locked data</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">sim_locked_in_raster</span>, <span class="va">sim_locked_out_raster</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Locked In"</span>, <span class="st">"Locked Out"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-27-1.png" width="624" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem using raster planning unit data and use the locked raster</span>
<span class="co"># data to lock in some planning units and lock out some other planning units</span>
<span class="va">p21</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="va">sim_locked_in_raster</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_out_constraints.html">add_locked_out_constraints</a></span><span class="op">(</span><span class="va">sim_locked_out_raster</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p21</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked out planning units [10 locked units]</span>
<span class="co">##                    Locked in planning units [10 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<p>If our planning unit data are in a spatial vector format (similar to the <code>sim_pu_polygons</code> data) or a tabular format (similar to <code>pu_dat</code>), we can use the field names in the data to refer to which planning units should be locked in and / or out. For example, the <code>sim_pu_polygons</code> object has <code>TRUE</code> / <code>FALSE</code> values in the “locked_in” field which indicate which planning units should be selected in the solution. We could use the data in this field to specify that those planning units with <code>TRUE</code> values should be locked in using the following methods.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># preview first six rows of the attribute table for sim_pu_polygons</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       cost locked_in locked_out</span>
<span class="co">## 1 215.8638     FALSE      FALSE</span>
<span class="co">## 2 212.7823     FALSE      FALSE</span>
<span class="co">## 3 207.4962     FALSE      FALSE</span>
<span class="co">## 4 208.9322     FALSE       TRUE</span>
<span class="co">## 5 214.0419     FALSE      FALSE</span>
<span class="co">## 6 213.7636     FALSE      FALSE</span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specify locked in data using the field name</span>
<span class="va">p22</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, <span class="va">sim_features</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="st">"locked_in"</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p22</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: SpatialPolygonsDataFrame (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked in planning units [10 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specify locked in data using the values in the field</span>
<span class="va">p23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span>, <span class="va">sim_features</span>, cost_column <span class="op">=</span> <span class="st">"cost"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim_pu_polygons</span><span class="op">$</span><span class="va">locked_in</span><span class="op">)</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p23</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: SpatialPolygonsDataFrame (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked in planning units [10 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
</div>
<div class="section level3">
<h3 id="add-penalties">Add penalties<a class="anchor" aria-label="anchor" href="#add-penalties"></a>
</h3>
<p>We can also add penalties to a problem to favor or penalize solutions according to a secondary objective. Unlike the constraint functions, these functions will add extra information to the objective function of the optimization function to penalize solutions that do not exhibit specific characteristics. For example, penalties can be added to a problem to avoid highly fragmented solutions at the expense of accepting slightly more expensive solutions. All penalty functions have a <code>penalty</code> argument that controls the relative importance of the secondary penalty function compared to the primary objective function. It is worth noting that incredibly low or incredibly high <code>penalty</code> values – relative to the main objective function – can cause problems to take a very long time to solve, so when trying out a range of different penalty values it can be helpful to limit the solver to run for a set period of time. The following penalties are available.</p>
<ul>
<li>
<strong>Boundary penalties</strong>: Add penalties to penalize solutions that are excessively fragmented. These penalties are similar to those used in <em>Marxan</em> <span class="citation">(Ball <em>et al.</em> 2009; Beyer <em>et al.</em> 2016)</span>.</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with penalties that penalize fragmented solutions with a</span>
<span class="co"># penalty factor of 0.01</span>
<span class="va">p24</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_boundary_penalties.html">add_boundary_penalties</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p24</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 0.5, max: 0.5), penalty (0.01), zones]&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Connectivity penalties</strong>: Add penalties to favor solutions that select combinations of planning units with high connectivity between them. These penalties are similar to those used in <em>Marxan with Zones</em> <span class="citation">(Watts <em>et al.</em> 2009; Beyer <em>et al.</em> 2016)</span>. This function supports both symmetric and asymmetric connectivities among planning units.</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create problem with penalties that favor combinations of planning units with</span>
<span class="co"># high connectivity, here we will use only the first four layers in</span>
<span class="co"># sim_features for the features and we will use the fifth layer in sim_features</span>
<span class="co"># to represent the connectivity data, where the connectivity_matrix function</span>
<span class="co"># will create a matrix showing the average strength of connectivity between</span>
<span class="co"># adjacent planning units using the data in the fifth layer of sim_features</span>
<span class="va">p25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_boundary_penalties.html">add_boundary_penalties</a></span><span class="op">(</span>
         penalty <span class="op">=</span> <span class="fl">5</span>,
         data <span class="op">=</span> <span class="fu"><a href="../reference/connectivity_matrix.html">connectivity_matrix</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p25</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, layer.4 (4 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 0.5, max: 0.5), penalty (5), zones]&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Linear penalties</strong>: Add penalties to penalize solutions that select planning units according to a certain variable (e.g., anthropogenic pressure).</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create data for penalizing planning units</span>
<span class="co"># (note this requires the RandomFields package to be installed)</span>
<span class="va">pen_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cost.html">simulate_cost</a></span><span class="op">(</span><span class="va">sim_pu_raster</span><span class="op">)</span>

<span class="co"># create problem with penalties that penalize solutions that select</span>
<span class="co"># planning units with high values in the pen_raster object,</span>
<span class="co"># here we will use a penalty value of 5 to indicate the trade-off (scaling)</span>
<span class="co"># between the penalty values (in the sim_pu_raster) and the main objective</span>
<span class="co"># (i.e., the cost of the solution)</span>
<span class="va">p26</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_linear_penalties.html">add_linear_penalties</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">pen_raster</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p26</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;Linear penalties [penalty (5)]&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
</div>
<div class="section level3">
<h3 id="add-the-decision-types">Add the decision types<a class="anchor" aria-label="anchor" href="#add-the-decision-types"></a>
</h3>
<p>Conservation planning problems involve making decisions on how planning units will be managed. These decisions are then associated with management actions (e.g., turning a planning unit into a protected area). The type of decision describes how the action is applied to planning units. For instance, the default decision-type is a binary decision type, meaning that we are either selecting or not selecting planning units for management. The following decision types are available.</p>
<ul>
<li>
<strong>Binary decisions</strong>: Add a binary decision to a conservation planning problem. This is the classic decision of either prioritizing or not prioritizing a planning unit. Typically, this decision has the assumed action of buying the planning unit to include in a protected area network. If no decision is added to a problem object, then this decision class will be used by default.</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add binary decisions to a problem</span>
<span class="va">p27</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p27</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Proportion decisions</strong>: Add a proportion decision to a problem. This is a relaxed decision where a part of a planning unit can be prioritized, as opposed to the default of the entire planning unit. Typically, this decision has the assumed action of buying a fraction of a planning unit to include in a protected area network. Generally, problems can be solved much faster with proportion-type decisions than binary-type decisions, so they can be very useful when commercial solvers are not available.</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add proportion decisions to a problem</span>
<span class="va">p28</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_proportion_decisions.html">add_proportion_decisions</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p28</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Proportion decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Semi-continuous decisions</strong>: Add a semi-continuous decision to a problem. This decision is similar to proportion decisions except that it has an upper bound parameter. By default, the decision can range from prioritizing none (0%) to all (100%) of a planning unit. However, a upper bound can be specified to ensure that at most only a fraction (e.g., 80%) of a planning unit can be purchased. This type of decision may be useful when it is not practical to conserve the entire area indicated by a planning unit.</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add semi-continuous decisions to a problem, where we can only manage at most</span>
<span class="co"># 50 % of the area encompassed by a planning unit</span>
<span class="va">p29</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_semicontinuous_decisions.html">add_semicontinuous_decisions</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p29</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Semicontinuous decision [upper limit (0.5)]</span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
</div>
<div class="section level3">
<h3 id="add-a-solver">Add a solver<a class="anchor" aria-label="anchor" href="#add-a-solver"></a>
</h3>
<p>Next, after specifying the mathematical formulation that underpins your conservation planning problem, you can specify how the problem should be solved. If you do not specify this information, the <em>prioritizr R</em> package will automatically use the best solver currently installed on your system with some reasonable defaults. <strong>We strongly recommend installing the <a href="https://www.gurobi.com/" class="external-link">Gurobi software suite and the <em>gurobi</em> <em>R</em> package</a> to solve problems, and for more information on this topic please refer to the <a href="gurobi_installation.html">Gurobi Installation Guide</a></strong>. The following solvers are available.</p>
<ul>
<li>
<strong><em>Gurobi</em> solver</strong>: <a href="https://www.gurobi.com/" class="external-link"><em>Gurobi</em></a> is a state of the art commercial optimization software. It is by far the fastest of the solvers that can be used to solve conservation problems. However, it is not freely available. That said, special licenses are available to academics at no cost.</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that Gurobi should be used to solve the problem</span>
<span class="co"># and specify an optimality gap of zero to obtain the optimal solution</span>
<span class="va">p30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_gurobi_solver.html">add_gurobi_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p30</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         Gurobi [first_feasible (0), gap (0), node_file_start (-1), numeric_focus (0), presolve (2), threads (1), time_limit (2147483647), verbose (1)]</span></code></pre>
<ul>
<li>
<strong><em>IBM CPLEX</em> solver</strong>: <a href="https://www.ibm.com/analytics/cplex-optimizer" class="external-link"><em>IBM CPLEX</em></a> is a commercial optimization software. It is faster than the open source solvers available for generating prioritizations (see below), however, it is not freely available. Similar to the <em>Gurobi</em> software, special licenses are available to academics at no cost.</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that IBM CPLEX should be used to solve the</span>
<span class="co"># problem and specify an optimality gap of zero to obtain the optimal solution</span>
<span class="va">p31</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_cplex_solver.html">add_cplex_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p31</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         CPLEX [gap (0), presolve (1), threads (1), time_limit (2147483647), verbose (1)]</span></code></pre>
<ul>
<li>
<strong><em>CBC</em> solver</strong>: <a href="https://projects.coin-or.org/Cbc" class="external-link"><em>CBC</em></a> is an open-source mixed integer programming solver that is part of the Computational Infrastructure for Operations Research (COIN-OR) project. Although formal benchmarks have yet to be completed, preliminary analyses suggest that it is the fastest open-source solver available for generating prioritizations. It requires the <em>rcbc R</em> package, which is currently only available on <a href="https://github.com/dirkschumacher/rcbc" class="external-link">GitHub</a>.</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that CBC should be used to solve the</span>
<span class="co"># problem and specify an optimality gap of zero to obtain the optimal solution</span>
<span class="va">p32</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_cbc_solver.html">add_cbc_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p32</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         CBC [first_feasible (0), gap (0), presolve (1), threads (1), time_limit (2147483647), verbose (1)]</span></code></pre>
<ul>
<li>
<strong><em>lpsymphony</em> solver</strong>: <a href="https://projects.coin-or.org/SYMPHONY" class="external-link"><em>SYMPHONY</em></a> is an open-source integer programming solver that is also part of the COIN-OR project. This solver uses the <em>lpsymphony R</em> package (available on <a href="http://bioconductor.org/packages/release/bioc/html/lpsymphony.html" class="external-link">Bioconductor</a>) to interface with the <em>SYMPHONY</em> software.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that lpsymphony should be used to solve the</span>
<span class="co"># problem and specify an optimality gap of zero to obtain the optimal solution</span>
<span class="va">p33</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_lsymphony_solver.html">add_lpsymphony_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p33</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         Lpsymphony [first_feasible (0), gap (0), time_limit (2147483647), verbose (1)]</span></code></pre>
<ul>
<li>
<strong><em>Rsymphony</em> solver</strong>: This solver provides a different interface to the <a href="https://projects.coin-or.org/SYMPHONY" class="external-link"><em>SYMPHONY</em></a> software. It uses the <em>Rsymphony R</em> package which is available on The Comprehensive R Archive Network (CRAN). This solver is generally slower than the other solvers, because it cannot use parallel processing.</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that Rsymphony should be used to solve the</span>
<span class="co"># problem and specify an optimality gap of zero to obtain the optimal solution</span>
<span class="va">p34</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_rsymphony_solver.html">add_rsymphony_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p34</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         Rsymphony [first_feasible (0), gap (0), time_limit (2147483647), verbose (1)]</span></code></pre>
</div>
<div class="section level3">
<h3 id="add-a-portfolio">Add a portfolio<a class="anchor" aria-label="anchor" href="#add-a-portfolio"></a>
</h3>
<p>Many conservation planning exercises require a portfolio of solutions. For example, real-world exercises can involve presenting decision makers with a range of near-optimal decisions. Additionally, the number of times that different planning units are selected in different solutions can provide insight into their relative importance. The following portfolio methods are available.</p>
<ul>
<li>
<strong>Gap portfolio</strong>: Generate a portfolio of solutions by finding a certain number of solutions that are all within a pre-specified optimality gap. This method is especially useful for generating multiple solutions that can used be to calculate selection frequencies (similar to <em>Marxan</em>). Note that this method requires that the <em>Gurobi</em> optimization software is used to generate solutions.</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that a portfolio should be created by</span>
<span class="co"># finding five solutions within 10% of optimality</span>
<span class="va">p35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_gap_portfolio.html">add_gap_portfolio</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">5</span>, pool_gap <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p35</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      Gap portfolio [number_solutions (5), pool_gap (0.2)]</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Top portfolio</strong>: Generate a portfolio of solutions by finding a pre-specified number of solutions that are closest to optimality (i.e the top solutions). Note that this method requires that the <em>Gurobi</em> optimization software is used to generate solutions.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that a portfolio should be created using</span>
<span class="co"># the top five solutions</span>
<span class="va">p36</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_top_portfolio.html">add_top_portfolio</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p36</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      Top portfolio [number_solutions (5)]</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Extra portfolio</strong>: Generate a portfolio of solutions by storing feasible solutions found during the optimization process. Note that this method requires that the <em>Gurobi</em> optimization software is used to generate solutions.</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that a portfolio should be created using</span>
<span class="co"># extra solutions found while solving the problem</span>
<span class="va">p37</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_extra_portfolio.html">add_extra_portfolio</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p37</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      Extra portfolio</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Cuts portfolio</strong>: Generate a portfolio of distinct solutions within a pre-specified optimality gap. This method is only recommended if the <em>Gurobi</em> optimization solver is not available.</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify that a portfolio containing 10 solutions</span>
<span class="co"># should be created using using Bender's cuts</span>
<span class="va">p38</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_cuts_portfolio.html">add_cuts_portfolio</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p38</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      Cuts portfolio [number_solutions (10)]</span>
<span class="co">##   solver:         default</span></code></pre>
<ul>
<li>
<strong>Shuffle portfolio</strong>: Generate a portfolio of solutions by randomly reordering the data prior to attempting to solve the problem. If the <em>Gurobi</em> optimization solver is not available, this method is the fastest method for generating a set number of solutions within a specified distance from optimality.</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a problem and specify a portfolio should be created that contains</span>
<span class="co"># 10 solutions and that any duplicate solutions should not be removed</span>
<span class="va">p39</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_shuffle_portfolio.html">add_shuffle_portfolio</a></span><span class="op">(</span>number_solutions <span class="op">=</span> <span class="fl">10</span>, remove_duplicates <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">p39</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: RasterLayer (90 units)</span>
<span class="co">##   cost:           min: 190.13276, max: 215.86384</span>
<span class="co">##   features:       layer.1, layer.2, layer.3, ... (5 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.1, max: 0.1)]</span>
<span class="co">##   decisions:      Binary decision </span>
<span class="co">##   constraints:    &lt;none&gt;</span>
<span class="co">##   penalties:      &lt;none&gt;</span>
<span class="co">##   portfolio:      Shuffle portfolio [number_solutions (10), remove_duplicates (0), threads (1)]</span>
<span class="co">##   solver:         default</span></code></pre>
</div>
<div class="section level3">
<h3 id="solve-the-problem">Solve the problem<a class="anchor" aria-label="anchor" href="#solve-the-problem"></a>
</h3>
<p>After formulating our conservation planning problem and specifying how the problem should be solved, we can use the <code>solve</code> function to obtain a solution. Note that the solver will typically print out some information describing the size of the problem and report its progress when searching for a suitable solution.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># formulate the problem</span>
<span class="va">p40</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_boundary_penalties.html">add_boundary_penalties</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">500</span>, edge_factor <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># solve the problem (using the default solver)</span>
<span class="va">s40</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Gurobi Optimizer version 9.5.0 build v9.5.0rc5 (linux64)</span>
<span class="co">## Thread count: 4 physical cores, 8 logical processors, using up to 1 threads</span>
<span class="co">## Optimize a model with 293 rows, 234 columns and 1026 nonzeros</span>
<span class="co">## Model fingerprint: 0xbd38144b</span>
<span class="co">## Variable types: 0 continuous, 234 integer (234 binary)</span>
<span class="co">## Coefficient statistics:</span>
<span class="co">##   Matrix range     [2e-01, 1e+00]</span>
<span class="co">##   Objective range  [1e+02, 4e+02]</span>
<span class="co">##   Bounds range     [1e+00, 1e+00]</span>
<span class="co">##   RHS range        [3e+00, 8e+00]</span>
<span class="co">## Found heuristic solution: objective 20287.196992</span>
<span class="co">## Found heuristic solution: objective 3087.9617505</span>
<span class="co">## Presolve time: 0.00s</span>
<span class="co">## Presolved: 293 rows, 234 columns, 1026 nonzeros</span>
<span class="co">## Variable types: 0 continuous, 234 integer (234 binary)</span>
<span class="co">## Root relaxation presolved: 293 rows, 234 columns, 1026 nonzeros</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## Root relaxation: objective 2.265862e+03, 220 iterations, 0.00 seconds (0.00 work units)</span>
<span class="co">## </span>
<span class="co">##     Nodes    |    Current Node    |     Objective Bounds      |     Work</span>
<span class="co">##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span>
<span class="co">## </span>
<span class="co">##      0     0 2265.86242    0  234 3087.96175 2265.86242  26.6%     -    0s</span>
<span class="co">##      0     0 2325.53449    0  232 3087.96175 2325.53449  24.7%     -    0s</span>
<span class="co">##      0     0 2361.03063    0  223 3087.96175 2361.03063  23.5%     -    0s</span>
<span class="co">##      0     0 2371.27288    0  222 3087.96175 2371.27288  23.2%     -    0s</span>
<span class="co">##      0     0 2371.27288    0  222 3087.96175 2371.27288  23.2%     -    0s</span>
<span class="co">## H    0     0                    2790.8740409 2371.27288  15.0%     -    0s</span>
<span class="co">## H    0     0                    2730.9524342 2371.27288  13.2%     -    0s</span>
<span class="co">##      0     2 2372.02804    0  222 2730.95243 2372.02804  13.1%     -    0s</span>
<span class="co">## H    6     6                    2604.7426048 2375.46233  8.80%  21.0    0s</span>
<span class="co">## </span>
<span class="co">## Cutting planes:</span>
<span class="co">##   Gomory: 3</span>
<span class="co">## </span>
<span class="co">## Explored 7 nodes (489 simplex iterations) in 0.08 seconds (0.10 work units)</span>
<span class="co">## Thread count was 1 (of 8 available processors)</span>
<span class="co">## </span>
<span class="co">## Solution count 5: 2604.74 2730.95 2790.87 ... 20287.2</span>
<span class="co">## </span>
<span class="co">## Optimal solution found (tolerance 1.00e-01)</span>
<span class="co">## Best objective 2.604742604847e+03, best bound 2.375462328932e+03, gap 8.8024%</span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot solution</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s40</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Solution"</span>,
     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-45-1.png" width="336" style="display: block; margin: auto;"></p>
<p>We can plot this solution because the planning unit input data are spatially referenced in a raster format. The output format will always match the planning unit data used to initialize the problem. For example, the solution to a problem with planning units in a spatial vector (shapefile) format would also be in a spatial vector format. Similarly, if the planning units were in a tabular format (i.e., <code>data.frame</code>), the solution would also be returned in a tabular format.</p>
<p>We can also extract attributes from the solution that describe the quality of the solution and the optimization process.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract the objective (numerical value being minimized or maximized)</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s40</span>, <span class="st">"objective"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## solution_1 </span>
<span class="co">##   2604.743</span></code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract time spent solving solution</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s40</span>, <span class="st">"runtime"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## solution_1 </span>
<span class="co">##      0.101</span></code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract state message from the solver that describes why this specific</span>
<span class="co"># solution was returned</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s40</span>, <span class="st">"status"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## solution_1 </span>
<span class="co">##  "OPTIMAL"</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="evaluate-the-solution">Evaluate the solution<a class="anchor" aria-label="anchor" href="#evaluate-the-solution"></a>
</h2>
<p>Conservation planning involves making trade-offs between different criteria (e.g. overall cost, feature representation, connectivity). After obtaining a solution to a conservation planning problem, it is important to evaluate it to help understand the trade-offs made by the prioritization. This is also useful to compare different solutions with each other.</p>
<div class="section level3">
<h3 id="evaluating-performance">Evaluating performance<a class="anchor" aria-label="anchor" href="#evaluating-performance"></a>
</h3>
<p>Summary statistics can be computed to evaluate the overall performance of a solution based on certain criteria. The following summaries can be computed.</p>
<p>The following functions are available to summarize a solution:</p>
<ul>
<li>
<strong>Number summary</strong>: Calculate the number of planning units selected by a solution.</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistic</span>
<span class="fu"><a href="../reference/eval_n_summary.html">eval_n_summary</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span>
<span class="co">##   summary  cost</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> overall    10</span></code></pre>
<ul>
<li>
<strong>Cost summary</strong>: Calculate the total cost of a solution.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistic</span>
<span class="fu"><a href="../reference/eval_cost_summary.html">eval_cost_summary</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span>
<span class="co">##   summary  cost</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> overall <span style="text-decoration: underline;">2</span>005.</span></code></pre>
<ul>
<li>
<strong>Feature representation summary</strong>: Calculate how well features are represented by a solution. This function can be used for any type of problem.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistics</span>
<span class="fu"><a href="../reference/eval_feature_representation_summary.html">eval_feature_representation_summary</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 5</span></span>
<span class="co">##   summary feature total_amount absolute_held relative_held</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> overall layer.1         83.3          8.95         0.107</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> overall layer.2         31.2          3.22         0.103</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> overall layer.3         72.0          7.59         0.106</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> overall layer.4         42.7          4.34         0.102</span>
<span class="co">## <span style="color: #BCBCBC;">5</span> overall layer.5         56.7          5.89         0.104</span></code></pre>
<ul>
<li>
<strong>Target coverage summary</strong>: Calculate how well representation targets are met by a solution. This function can only be used with problems contain targets.</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistics</span>
<span class="fu"><a href="../reference/eval_target_coverage_summary.html">eval_target_coverage_summary</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 9</span></span>
<span class="co">##   feature met   total_amount absolute_target absolute_held absolute_shortfall</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> layer.1 TRUE          83.3            8.33          8.95                  0</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> layer.2 TRUE          31.2            3.12          3.22                  0</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> layer.3 TRUE          72.0            7.20          7.59                  0</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> layer.4 TRUE          42.7            4.27          4.34                  0</span>
<span class="co">## <span style="color: #BCBCBC;">5</span> layer.5 TRUE          56.7            5.67          5.89                  0</span>
<span class="co">##   relative_target relative_held relative_shortfall</span>
<span class="co">##             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span>             0.1         0.107                  0</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>             0.1         0.103                  0</span>
<span class="co">## <span style="color: #BCBCBC;">3</span>             0.1         0.106                  0</span>
<span class="co">## <span style="color: #BCBCBC;">4</span>             0.1         0.102                  0</span>
<span class="co">## <span style="color: #BCBCBC;">5</span>             0.1         0.104                  0</span></code></pre>
<ul>
<li>
<strong>Boundary summary</strong>: Calculate the total exposed boundary length (perimeter) associated with a solution.</li>
</ul>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistic</span>
<span class="fu"><a href="../reference/eval_boundary_summary.html">eval_boundary_summary</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span>
<span class="co">##   summary boundary</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> overall      1.2</span></code></pre>
<ul>
<li>
<strong>Connectivity summary</strong>: Calculate the connectivity facilitated within a solution.</li>
</ul>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate statistic</span>
<span class="co"># here we use the raster data for the first feature as an example</span>
<span class="co"># to parametrize pair-wise connectivity between different planning units</span>
<span class="fu"><a href="../reference/eval_connectivity_summary.html">eval_connectivity_summary</a></span><span class="op">(</span>
  <span class="va">p40</span>, <span class="va">s40</span>, data <span class="op">=</span> <span class="fu"><a href="../reference/connectivity_matrix.html">connectivity_matrix</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span>
<span class="co">##   summary connectivity</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> overall         1.97</span></code></pre>
</div>
<div class="section level3">
<h3 id="evaluating-relative-importance">Evaluating relative importance<a class="anchor" aria-label="anchor" href="#evaluating-relative-importance"></a>
</h3>
<p>Conservation plans can take a long time to implement. Since funding availability and habitat quality can decline over time, it is critical that the most important places in a prioritization are scheduled for management as early as possible. For instance, some planning units in a solution might contain many rare species which do not occur in any other planning units. Alternatively, some planning units might offer an especially high return on investment that reduces costs considerably. As a consequence, conservation planners often need information on which planning units selected in a prioritization are most important to the overall success of the prioritization. To achieve this, conservation planners can use importance scores for each planning unit selected by a solution.</p>
<p>Let’s generate a prioritization so that can compare the different importance methods.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># formulate the problem</span>
<span class="va">p41</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/problem.html">problem</a></span><span class="op">(</span><span class="va">sim_pu_raster</span>, <span class="va">sim_features</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_min_set_objective.html">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="../reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># solve the problem</span>
<span class="va">s41</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p41</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Gurobi Optimizer version 9.5.0 build v9.5.0rc5 (linux64)</span>
<span class="co">## Thread count: 4 physical cores, 8 logical processors, using up to 1 threads</span>
<span class="co">## Optimize a model with 5 rows, 90 columns and 450 nonzeros</span>
<span class="co">## Model fingerprint: 0x6442bf6e</span>
<span class="co">## Variable types: 0 continuous, 90 integer (90 binary)</span>
<span class="co">## Coefficient statistics:</span>
<span class="co">##   Matrix range     [2e-01, 9e-01]</span>
<span class="co">##   Objective range  [2e+02, 2e+02]</span>
<span class="co">##   Bounds range     [1e+00, 1e+00]</span>
<span class="co">##   RHS range        [3e+00, 8e+00]</span>
<span class="co">## Found heuristic solution: objective 2337.9617505</span>
<span class="co">## Presolve time: 0.00s</span>
<span class="co">## Presolved: 5 rows, 90 columns, 450 nonzeros</span>
<span class="co">## Variable types: 0 continuous, 90 integer (90 binary)</span>
<span class="co">## Found heuristic solution: objective 2332.1003790</span>
<span class="co">## Root relaxation presolved: 5 rows, 90 columns, 450 nonzeros</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## Root relaxation: objective 1.931582e+03, 12 iterations, 0.00 seconds (0.00 work units)</span>
<span class="co">## </span>
<span class="co">##     Nodes    |    Current Node    |     Objective Bounds      |     Work</span>
<span class="co">##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time</span>
<span class="co">## </span>
<span class="co">##      0     0 1931.58191    0    4 2332.10038 1931.58191  17.2%     -    0s</span>
<span class="co">## H    0     0                    1987.3985265 1931.58191  2.81%     -    0s</span>
<span class="co">## </span>
<span class="co">## Explored 1 nodes (12 simplex iterations) in 0.00 seconds (0.00 work units)</span>
<span class="co">## Thread count was 1 (of 8 available processors)</span>
<span class="co">## </span>
<span class="co">## Solution count 3: 1987.4 2332.1 2337.96 </span>
<span class="co">## </span>
<span class="co">## Optimal solution found (tolerance 1.00e-01)</span>
<span class="co">## Best objective 1.987398526526e+03, best bound 1.931581908865e+03, gap 2.8085%</span></code></pre>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot solution</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s41</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Solution"</span>,
     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-53-1.png" width="336" style="display: block; margin: auto;"></p>
<p>The following methods are available for computing importance scores.</p>
<ul>
<li>
<strong>Replacement cost</strong>: Evaluate importance using the replacement cost method <span class="citation">(Cabeza &amp; Moilanen 2006)</span>. This method quantifies the importance of a given planning unit as the decrease in the performance of the solution (based on the objective function) if the planning unit cannot be acquired (e.g., in terms of the additional costs required to meet feature targets). The advantages of this method are that it (i) accounts for the costs of the planning units, (ii) can be applied to multiple management zones, (iii) can be applied to any objective function, and (iv) can identify truly irreplaceable planning units (denoted with infinite values). However, the key disadvantage of this method, is that can take an infeasible amount of time to complete for large and complex problems.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate replacement cost scores and make the solver quiet</span>
<span class="va">rc41</span> <span class="op">&lt;-</span> <span class="va">p41</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
        <span class="fu"><a href="../reference/add_default_solver.html">add_default_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
        <span class="fu"><a href="../reference/eval_replacement_importance.html">eval_replacement_importance</a></span><span class="op">(</span><span class="va">s41</span><span class="op">)</span>

<span class="co"># plot replacement cost scores</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rc41</span>, main <span class="op">=</span> <span class="st">"Replacement cost scores"</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-54-1.png" width="336" style="display: block; margin: auto;"> * <strong>Ferrier method</strong>: Evaluate importance by computing irreplaceability scores following Ferrier <em>et al.</em> <span class="citation">(<strong>r-34?</strong>)</span>. The advantages of this method are that it (i) can be computed relatively quickly for moderate and large-sized problems, and (ii) calculates a score for each feature within each planning unit to provide insight into why certain planning units are more important than others. The disadvatange with this method is that it can only be applied to conservation problems with a minimum set objective and a single zone (i.e., similar to <em>Marxan</em>-type problems).</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate Ferrier scores and extract total score</span>
<span class="va">fs41</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_ferrier_importance.html">eval_ferrier_importance</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span><span class="op">[[</span><span class="st">"total"</span><span class="op">]</span><span class="op">]</span>

<span class="co"># plot Ferrier scores</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fs41</span>, main <span class="op">=</span> <span class="st">"Ferrier scores"</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-55-1.png" width="336" style="display: block; margin: auto;"> * <strong>Rarity weighted richness</strong>: Evaluate importance by computing rarity weighted richness scores <span class="citation">(Williams <em>et al.</em> 1996)</span>. The only advantage with this method is that it can be computed very quickly for very large problems. The key disadvantage with this approach is that it merely describes the spatial patterns of biodiversity, and does not consider any of the goals that underpin conservation planning exercise. For instance, it does not account for planning costs, management zones, objective functions, or feature representation targets.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate rarity weighted richness scores</span>
<span class="va">rwr41</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eval_rare_richness_importance.html">eval_rare_richness_importance</a></span><span class="op">(</span><span class="va">p40</span>, <span class="va">s40</span><span class="op">)</span>

<span class="co"># plot rarity weighted richness scores</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rwr41</span>, main <span class="op">=</span> <span class="st">"Rarity weighted richness"</span><span class="op">)</span></code></pre></div>
<p><img src="package_overview_files/figure-html/unnamed-chunk-56-1.png" width="336" style="display: block; margin: auto;"></p>
<p>In general, we recommend using replacement cost scores for small and moderate sized problems (e.g., less than 30,000 planning units) when it is feasible to do so. It can take a very long time to compute replacement cost scores, and so it is simply not feasible to compute these scores for particularly large problems. For moderate and large sized problems (e.g., more than 30,000 planning units), we recommend using the Ferrier method. This is because it explicitly accounts for representation targets, unlike the rarity weighted richness scores. We almost never recommend using the rarity weighted richness scores. This is because they do not consider criteria needed to inform conservation decision making <span class="citation">(Brown <em>et al.</em> 2015)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="marxan-problems">
<em>Marxan</em> problems<a class="anchor" aria-label="anchor" href="#marxan-problems"></a>
</h2>
<p>Although we encourage users to build and tailor conservation planning problems to suit their own needs, sometimes it just simply easier to use something you’re already familiar with. The <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function is provided as a convenient wrapper for building and solving <em>Marxan</em>-style conservation problems. If users already have their conservation planning data formatted for use with <em>Marxan</em>, this function can also read <em>Marxan</em> data files and solve the <em>Marxan</em>-style problems using exact algorithm solvers. <strong>Please note that problems built using the <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function are still solved the same way as a problem initialized using the <code><a href="../reference/problem.html">problem()</a></code> function, and therefore still require the installation of one of the solver packages.</strong></p>
<p>Here is a short example showing how the <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function can be used to read <em>Marxan</em> input files and the <code>solve</code> function can be used to solve the problem.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set file path for Marxan input file</span>
<span class="va">minput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span>

<span class="co"># read Marxan input file</span>
<span class="va">mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marxan_problem.html">marxan_problem</a></span><span class="op">(</span><span class="va">minput</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: data.frame (1751 units)</span>
<span class="co">##   cost:           min: 0, max: 41569219.38232</span>
<span class="co">##   features:       bird1, nvis2, nvis8, ... (17 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.3, max: 0.3)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked out planning units [1 locked units]</span>
<span class="co">##                    Locked in planning units [317 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 1, max: 1), penalty (1), zones]&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># solve the problem</span>
<span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve.html">solve</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span>

<span class="co"># since the Marxan data was in a tabular format, the solution is also returned</span>
<span class="co"># in a tabular format, so we will print the first six rows of the table</span>
<span class="co"># containing the solution</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span></code></pre></div>
<p>Alternatively, rather then using a <em>Marxan</em> input file to construct the problem, we can manually read in the <em>Marxan</em> data files and input these to the <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load data</span>
<span class="va">pu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/pu.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">","</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/spec.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
            <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">","</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/bound.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
         <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">"\t"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">rij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/input/puvspr.dat"</span>, package <span class="op">=</span> <span class="st">"prioritizr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
       <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">","</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># build Marxan problem using data.frame objects</span>
<span class="va">mp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marxan_problem.html">marxan_problem</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pu</span>, spec <span class="op">=</span> <span class="va">features</span>, puvspr <span class="op">=</span> <span class="va">rij</span>, bound <span class="op">=</span> <span class="va">bound</span>,
                      blm <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># print problem</span>
<span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">mp2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Conservation Problem</span>
<span class="co">##   planning units: data.frame (1751 units)</span>
<span class="co">##   cost:           min: 0, max: 41569219.38232</span>
<span class="co">##   features:       bird1, nvis2, nvis8, ... (17 features)</span>
<span class="co">##   objective:      Minimum set objective </span>
<span class="co">##   targets:        Relative targets [targets (min: 0.3, max: 0.3)]</span>
<span class="co">##   decisions:      default</span>
<span class="co">##   constraints:    &lt;Locked in planning units [317 locked units]</span>
<span class="co">##                    Locked out planning units [1 locked units]&gt;</span>
<span class="co">##   penalties:      &lt;Boundary penalties [edge factor (min: 1, max: 1), penalty (0), zones]&gt;</span>
<span class="co">##   portfolio:      default</span>
<span class="co">##   solver:         default</span></code></pre>
<p>Conservation planning problems that are built using the <code><a href="../reference/marxan_problem.html">marxan_problem()</a></code> function can also be customized. For example, we could change the decision type for <code>mp2</code> to involve selecting a proportion of each planing unit (using the <code><a href="../reference/add_proportion_decisions.html">add_proportion_decisions()</a></code> function).</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Hopefully, this vignette has provided an informative overview of the <em>prioritizr R</em> package. For more examples using the package, please see the other vignettes. Perhaps, one of the best ways to learn a new piece of software is to just try it out. Test it, try breaking it, make mistakes, and learn from them. We would recommend trying to build conservation planning problems that resemble those you face in your own work—but using the built-in example data sets. This way you can quickly verify that the problems you build actually mean what you think they mean. For instance, you can try playing around with the targets and see what effect they have on the solutions, or try playing around with penalties and see what effect they have on the solutions. Finally, if you have any questions about using the package or suggestions for it, please <a href="https://github.com/prioritizr/prioritizr/issues" class="external-link">post an issue on the package’s online coding repository</a>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-r23" class="csl-entry">
Achterberg, T. &amp; Wunderling, R. (2013). <span class="nocase">Mixed Integer Programming: Analyzing 12 Years of Progress</span>. <em>Facets of combinatorial optimization: Festschrift for martin gr<span>ö</span>tschel</em> (eds M. Jünger &amp; G. Reinelt), pp. 449–481. Springer, Berlin, Heidelberg.
</div>
<div id="ref-r3" class="csl-entry">
Ball, I.R., Possingham, H. &amp; Watts, M.E. (2009). <span class="nocase">Marxan and relatives: Software for spatial conservation prioritisation</span>. <em><span>Spatial Conservation Prioritisation: Quantitative Methods &amp; Computational Tools</span></em> (eds A. Moilanen, K.A. Wilson &amp; H. Possingham), pp. 185–189. Oxford University Press, Oxford, UK.
</div>
<div id="ref-r1" class="csl-entry">
Beyer, H.L., Dujardin, Y., Watts, M.E. &amp; Possingham, H.P. (2016). Solving conservation planning problems with integer linear programming. <em>Ecological Modelling</em>, <em>328</em>, 14–22.
</div>
<div id="ref-r16" class="csl-entry">
Billionnet, A. (2013). Mathematical optimization ideas for biodiversity conservation. <em>European Journal of Operational Research</em>, <em>231</em>, 514–534.
</div>
<div id="ref-r51" class="csl-entry">
Brown, C.J., Bode, M., Venter, O., Barnes, M.D., McGowan, J., Runge, C.A., Watson, J.E.M. &amp; Possingham, H.P. (2015). Effective conservation requires clear objectives and prioritizing actions, not places or species. <em>Proceedings of the National Academy of Sciences</em>, <em>112</em>, E4342.
</div>
<div id="ref-r20" class="csl-entry">
Butchart, S.H., Clarke, M., Smith, R.J., Sykes, R.E., Scharlemann, J.P., Harfoot, M., Buchanan, G.M., Angulo, A., Balmford, A., Bertzky, B. &amp; others. (2015). Shortfalls and solutions for meeting national and global conservation area targets. <em>Conservation Letters</em>, <em>8</em>, 329–337.
</div>
<div id="ref-r10" class="csl-entry">
Cabeza, M. &amp; Moilanen, A. (2001). Design of reserve networks and the persistence of biodiversity. <em>Trends in Ecology &amp; Evolution</em>, <em>16</em>, 242–248.
</div>
<div id="ref-r31" class="csl-entry">
Cabeza, M. &amp; Moilanen, A. (2006). Replacement cost: A practical measure of site value for cost-effective reserve planning. <em>Biological Conservation</em>, <em>132</em>, 336–342.
</div>
<div id="ref-r12" class="csl-entry">
Church, R.L., Stoms, D.M. &amp; Davis, F.W. (1996). Reserve selection as a maximal covering location problem. <em>Biological conservation</em>, <em>76</em>, 105–112.
</div>
<div id="ref-r13" class="csl-entry">
Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em>, <em>61</em>, 1–10.
</div>
<div id="ref-r19" class="csl-entry">
Fuller, R.A., McDonald-Madden, E., Wilson, K.A., Carwardine, J., Grantham, H.S., Watson, J.E., Klein, C.J., Green, D.C. &amp; Possingham, H.P. (2010). Replacing underperforming protected areas achieves better conservation outcomes. <em>Nature</em>, <em>466</em>, 365.
</div>
<div id="ref-r17" class="csl-entry">
Kirkpatrick, J.B. (1983). <span class="nocase">An iterative method for establishing priorities for the selection of nature reserves: An example from Tasmania</span>. <em>Biological Conservation</em>, <em>25</em>, 127–134.
</div>
<div id="ref-r6" class="csl-entry">
Kirkpatrick, S., Gelatt, C.D. &amp; Vecchi, M.P. (1983). Optimization by simulated annealing. <em>Science</em>, <em>220</em>, 671–680.
</div>
<div id="ref-r5" class="csl-entry">
Klein, C., Wilson, K., Watts, M., Stein, J., Berry, S., Carwardine, J., Smith, M.S., Mackey, B. &amp; Possingham, H. (2009). Incorporating ecological and evolutionary processes into continental-scale conservation planning. <em>Ecological Applications</em>, <em>19</em>, 206–217.
</div>
<div id="ref-r4" class="csl-entry">
Margules, C.R. &amp; Pressey, R.L. (2000). Systematic conservation planning. <em>Nature</em>, <em>405</em>, 243–253.
</div>
<div id="ref-r7" class="csl-entry">
Moilanen, A. (2007). <span class="nocase">Landscape Zonation, benefit functions and target-based planning: Unifying reserve selection strategies</span>. <em>Biological Conservation</em>, <em>134</em>, 571–579.
</div>
<div id="ref-r8" class="csl-entry">
Nicholls, A.O. &amp; Margules, C.R. (1993). An upgraded reserve selection algorithm. <em>Biological Conservation</em>, <em>64</em>, 165–169.
</div>
<div id="ref-r9" class="csl-entry">
Pressey, R.L., Possingham, H.P. &amp; Margules, C.R. (1996). <span class="nocase">Optimality in reserve selection algorithms: When does it matter and how much?</span> <em>Biological Conservation</em>, <em>76</em>, 259–267.
</div>
<div id="ref-r15" class="csl-entry">
Rodrigues, A.S., Akcakaya, H.R., Andelman, S.J., Bakarr, M.I., Boitani, L., Brooks, T.M., Chanson, J.S., Fishpool, L.D., Da Fonseca, G.A., Gaston, K.J. &amp; others. (2004). <span class="nocase">Global gap analysis: Priority regions for expanding the global protected-area network</span>. <em>BioScience</em>, <em>54</em>, 1092–1100.
</div>
<div id="ref-r14" class="csl-entry">
Rodrigues, A.S. &amp; Gaston, K.J. (2002). Maximising phylogenetic diversity in the selection of networks of conservation areas. <em>Biological Conservation</em>, <em>105</em>, 103–111.
</div>
<div id="ref-r11" class="csl-entry">
Rodrigues, A.S., Orestes Cerdeira, J. &amp; Gaston, K.J. (2000). <span class="nocase">Flexibility, efficiency, and accountability: Adapting reserve selection algorithms to more complex conservation problems</span>. <em>Ecography</em>, <em>23</em>, 565–574.
</div>
<div id="ref-r32" class="csl-entry">
Rosauer, D., Laffan, S.W., Crisp, M.D., Donnellan, S.C. &amp; Cook, L.G. (2009). Phylogenetic endemism: A new approach for identifying geographical concentrations of evolutionary history. <em>Molecular Ecology</em>, <em>18</em>, 4061–4072.
</div>
<div id="ref-r18" class="csl-entry">
Stigner, M.G., Beyer, H.L., Klein, C.J. &amp; Fuller, R.A. (2016). Reconciling recreational use and conservation values in a coastal protected area. <em>Journal of Applied Ecology</em>, <em>53</em>, 1206–1214.
</div>
<div id="ref-r2" class="csl-entry">
Watts, M.E., Ball, I.R., Stewart, R.S., Klein, C.J., Wilson, K., Steinback, C., Lourival, R., Kircher, L. &amp; Possingham, H.P. (2009). <span class="nocase">Marxan with Zones: Software for optimal conservation based land- and sea-use zoning</span>. <em>Environmental Modelling &amp; Software</em>, <em>24</em>, 1513–1521.
</div>
<div id="ref-r33" class="csl-entry">
Williams, P., Gibbons, D., Margules, C., Rebelo, A., Humphries, C. &amp; Pressey, R. (1996). <span class="nocase">A comparison of richness hotspots, rarity hotspots, and complementary areas for conserving diversity of British birds</span>. <em>Conservation Biology</em>, <em>10</em>, 155–174.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com" class="external-link">Richard Schuster</a>, Nina Morrell, <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Brandon P M Edwards, Matthew E Watts, <a href="https://arcese.forestry.ubc.ca" class="external-link">Peter Arcese</a>, <a href="https://josephrbennett.wordpress.com" class="external-link">Joseph Bennett</a>, <a href="http://www.possinghamlab.org" class="external-link">Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
