<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Systematic Conservation Prioritization in R • prioritizr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Systematic Conservation Prioritization in R">
<meta name="description" content="Systematic conservation prioritization using mixed integer linear programming (MILP). It provides a flexible interface for building and solving conservation planning problems. Once built, conservation planning problems can be solved using a variety of commercial and open-source exact algorithm solvers. By using exact algorithm solvers, solutions can be generated that are guaranteed to be optimal (or within a pre-specified optimality gap). Furthermore, conservation problems can be constructed to optimize the spatial allocation of different management actions or zones, meaning that conservation practitioners can identify solutions that benefit multiple stakeholders. To solve large-scale or complex conservation planning problems, users should install the Gurobi optimization software (available from &lt;https://www.gurobi.com/&gt;) and the gurobi R package (see Gurobi Installation Guide vignette for details). Users can also install the IBM CPLEX software (&lt;https://www.ibm.com/products/ilog-cplex-optimization-studio/cplex-optimizer&gt;) and the cplexAPI R package (available at &lt;https://github.com/cran/cplexAPI&gt;). Additionally, the rcbc R package (available at &lt;https://github.com/dirkschumacher/rcbc&gt;) can be used to generate solutions using the CBC optimization software (&lt;https://github.com/coin-or/Cbc&gt;). For further details, see Hanson et al. (2025) &lt;doi:10.1111/cobi.14376&gt;.">
<meta property="og:description" content="Systematic conservation prioritization using mixed integer linear programming (MILP). It provides a flexible interface for building and solving conservation planning problems. Once built, conservation planning problems can be solved using a variety of commercial and open-source exact algorithm solvers. By using exact algorithm solvers, solutions can be generated that are guaranteed to be optimal (or within a pre-specified optimality gap). Furthermore, conservation problems can be constructed to optimize the spatial allocation of different management actions or zones, meaning that conservation practitioners can identify solutions that benefit multiple stakeholders. To solve large-scale or complex conservation planning problems, users should install the Gurobi optimization software (available from &lt;https://www.gurobi.com/&gt;) and the gurobi R package (see Gurobi Installation Guide vignette for details). Users can also install the IBM CPLEX software (&lt;https://www.ibm.com/products/ilog-cplex-optimization-studio/cplex-optimizer&gt;) and the cplexAPI R package (available at &lt;https://github.com/cran/cplexAPI&gt;). Additionally, the rcbc R package (available at &lt;https://github.com/dirkschumacher/rcbc&gt;) can be used to generate solutions using the CBC optimization software (&lt;https://github.com/coin-or/Cbc&gt;). For further details, see Hanson et al. (2025) &lt;doi:10.1111/cobi.14376&gt;.">
<meta property="og:image" content="https://prioritizr.net/logo.png">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">prioritizr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">8.0.6.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/prioritizr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/package_overview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="articles/gurobi_installation_guide.html">Gurobi installation guide</a></li>
    <li><a class="dropdown-item" href="articles/solver_benchmarks.html">Solver benchmarks</a></li>
    <li><a class="dropdown-item" href="articles/publication_record.html">Publication record</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="articles/connectivity_tutorial.html">Connectivity</a></li>
    <li><a class="dropdown-item" href="articles/calibrating_trade-offs_tutorial.html">Calibrating trade-offs</a></li>
    <li><a class="dropdown-item" href="articles/management_zones_tutorial.html">Management zones</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/prioritizr/prioritizr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="prioritizr-">prioritizr <a class="anchor" aria-label="anchor" href="#prioritizr-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="systematic-conservation-prioritization-in-r">Systematic Conservation Prioritization in R<a class="anchor" aria-label="anchor" href="#systematic-conservation-prioritization-in-r"></a>
</h2>
<!-- badges: start -->

<!-- badges: end -->
<p>The <em>prioritizr R</em> package uses mixed integer linear programming (MILP) techniques to provide a flexible interface for building and solving conservation planning problems. It supports a broad range of objectives, constraints, and penalties that can be used to custom-tailor conservation planning problems to the specific needs of a conservation planning exercise. Once built, conservation planning problems can be solved using a variety of commercial and open-source exact algorithm solvers. In contrast to the algorithms conventionally used to solve conservation problems, such as heuristics or simulated annealing, the exact algorithms used here are guaranteed to find optimal solutions. Furthermore, conservation problems can be constructed to optimize the spatial allocation of different management actions or zones, meaning that conservation practitioners can identify solutions that benefit multiple stakeholders. Finally, this package has the functionality to read input data formatted for the <em>Marxan</em> conservation planning program, and find much cheaper solutions in a much shorter period of time than <em>Marxan</em>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level4">
<h4 id="official-version">Official version<a class="anchor" aria-label="anchor" href="#official-version"></a>
</h4>
<p>The latest official version of the <em>prioritizr R</em> package can be installed from the <a href="https://cran.r-project.org/" class="external-link">Comprehensive R Archive Network (CRAN)</a> using the following <em>R</em> code.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"prioritizr"</span>, repos <span class="op">=</span> <span class="st">"https://cran.rstudio.com/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="developmental-version">Developmental version<a class="anchor" aria-label="anchor" href="#developmental-version"></a>
</h4>
<p>The latest development version can be installed to gain access to new functionality that is not yet present in the latest official version. Please note that the developmental version is more likely to contain coding errors than the official version. To install the developmental version, you can install it directly from the <a href="https://github.com/prioritizr/prioritizr" class="external-link">GitHub online code repository</a> or from the <a href="https://prioritizr.r-universe.dev/prioritizr" class="external-link">R Universe</a>. In general, we recommend installing the developmental version from the <a href="https://prioritizr.r-universe.dev/prioritizr" class="external-link">R Universe</a>. This is because installation via <a href="https://prioritizr.r-universe.dev/prioritizr" class="external-link">R Universe</a> does not require any additional software (e.g., <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">RTools</a> for Windows systems, or <a href="https://mac.r-project.org/tools/" class="external-link">Xcode and gfortran</a> for macOS systems).</p>
<ul>
<li>
<p>To install the latest development version from <a href="https://prioritizr.r-universe.dev/prioritizr" class="external-link">R Universe</a>, use the following <em>R</em> code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"prioritizr"</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"https://prioritizr.r-universe.dev"</span>,</span>
<span>    <span class="st">"https://cloud.r-project.org"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>To install the latest development version from <a href="https://github.com/prioritizr/prioritizr" class="external-link">GitHub</a>, use the following <em>R</em> code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"prioritizr/prioritizr"</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Please cite the <em>prioritizr R</em> package when using it in publications. To cite the package, please use:</p>
<blockquote>
<p>Hanson JO, Schuster R, Strimas‐Mackey M, Morrell N, Edwards BPM, Arcese P, Bennett JR, and Possingham HP (2025) Systematic conservation prioritization with the prioritizr R package. <em>Conservation Biology</em>, <strong>39</strong>: e14376.</p>
</blockquote>
<p>Additionally, we keep a <a href="https://prioritizr.net/articles/publication_record.html">record of publications</a> that use the <em>prioritizr R</em> package. If you use this package in any reports or publications, please <a href="https://github.com/prioritizr/prioritizr/issues/new" class="external-link">file an issue on GitHub</a> so we can add it to the record.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Here we provide a short example showing how the <em>prioritizr R</em> package can be used to build and solve conservation problems. Specifically, we will use an example dataset available through the <em>prioritizrdata R</em> package. Additionally, we will use the <em>terra R</em> package to perform raster calculations. To begin with, we will load the packages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.net">prioritizr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.github.io/prioritizrdata/" class="external-link">prioritizrdata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<p>We will use the Washington dataset in this example. To import the planning unit data, we will use the <code><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_pu()</a></code> function. Although the <em>prioritizr R</em> package can support many different types of planning unit data, here our planning units are represented as a single-layer raster (i.e., <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> object). Each cell represents a different planning unit, and cell values denote land acquisition costs. Specifically, there are 10757 planning units in total (i.e., cells with non-missing values).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import planning unit data</span></span>
<span><span class="va">wa_pu</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_pu</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># preview data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wa_pu</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="do">## size        : 109, 147, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="do">## resolution  : 4000, 4000  (x, y)</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="do">## extent      : -1816382, -1228382, 247483.5, 683483.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="do">## coord. ref. : +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">## source      : wa_pu.tif </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="do">## name        :         cost </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="do">## min value   :    0.2986647 </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="do">## max value   : 1804.1838379</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wa_pu</span>, main <span class="op">=</span> <span class="st">"Costs"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-planning_units-1.png" width="500" style="display: block; margin: auto;"></p>
<p>Next, we will use the <code><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_features()</a></code> function to import the conservation feature data. Although the <em>prioritizr R</em> package can support many different types of feature data, here our feature data are represented as a multi-layer raster (i.e., <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> object). Each layer describes the spatial distribution of a feature. Here, our feature data correspond to different bird species. To account for migratory patterns, the breeding and non-breeding distributions of species are represented as different features. Specifically, the cell values denote the relative abundance of individuals, with higher values indicating greater abundance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import feature data</span></span>
<span><span class="va">wa_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_features</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># preview data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wa_features</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="do">## size        : 109, 147, 396  (nrow, ncol, nlyr)</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="do">## resolution  : 4000, 4000  (x, y)</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">## extent      : -1816382, -1228382, 247483.5, 683483.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## coord. ref. : +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## source      : wa_features.tif </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## names       : Recur~ding), Botau~ding), Botau~ding), Corvu~ding), Corvu~ding), Cincl~full), ... </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## min values  :       0.000,       0.000,       0.000,       0.000,       0.000,        0.00, ... </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## max values  :       0.514,       0.812,       3.129,       0.115,       0.296,        0.06, ...</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the first nine features</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wa_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span>, nr <span class="op">=</span> <span class="fl">3</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-features-1.png" width="800" style="display: block; margin: auto;"></p>
<p>Let’s make sure that you have a solver installed on your computer. This is important so that you can use optimization algorithms to generate spatial prioritizations. If this is your first time using the <em>prioritizr R</em> package, please install the HiGHS solver using the following <em>R</em> code. Although the HiGHS solver is relatively fast and easy to install, please note that you’ll need to install the <a href="https://www.gurobi.com/" class="external-link">Gurobi software suite and the <em>gurobi</em> <em>R</em> package</a> for best performance (see the <a href="https://prioritizr.net/articles/gurobi_installation_guide.html">Gurobi Installation Guide</a> for details).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if needed, install HiGHS solver</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"highs"</span>, repos <span class="op">=</span> <span class="st">"https://cran.rstudio.com/"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s generate a spatial prioritization. To ensure feasibility, we will set a budget. Specifically, the total cost of the prioritization will represent a 5% of the total land value in the study area. Given this budget, we want the prioritization to increase feature representation, as much as possible, so that each feature would, ideally, have 20% of its distribution covered by the prioritization. In this scenario, we can either purchase all of the land inside a given planning unit, or none of the land inside a given planning unit. Thus we will create a new <code><a href="reference/problem.html">problem()</a></code> that will use a minimum shortfall objective (via <code><a href="reference/add_min_shortfall_objective.html">add_min_shortfall_objective()</a></code>), with relative targets of 20% (via <code><a href="reference/add_relative_targets.html">add_relative_targets()</a></code>), binary decisions (via <code><a href="reference/add_binary_decisions.html">add_binary_decisions()</a></code>), and specify that we want near-optimal solutions (i.e., 10% from optimality) using the best solver installed on our computer (via <code><a href="reference/add_default_solver.html">add_default_solver()</a></code>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate budget</span></span>
<span><span class="va">budget</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">wa_pu</span>, <span class="st">"sum"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># create problem</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/problem.html">problem</a></span><span class="op">(</span><span class="va">wa_pu</span>, features <span class="op">=</span> <span class="va">wa_features</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_min_shortfall_objective.html">add_min_shortfall_objective</a></span><span class="op">(</span><span class="va">budget</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_relative_targets.html">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_binary_decisions.html">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_default_solver.html">add_default_solver</a></span><span class="op">(</span>gap <span class="op">=</span> <span class="fl">0.1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print problem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## A conservation problem (&lt;ConservationProblem&gt;)</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="do">## ├•data</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="do">## │├•features:    "Recurvirostra americana (breeding)", … (396 total)</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="do">## │└•planning units:</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="do">## │ ├•data:       &lt;SpatRaster&gt; (10757 total)</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="do">## │ ├•costs:      continuous values (between 0.2987 and 1804.1838)</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="do">## │ ├•extent:     -1816381.6182, 247483.5211, -1228381.6182, 683483.5211 (xmin, ymin, xmax, ymax)</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="do">## │ └•CRS:        +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs (projected)</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="do">## ├•formulation</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="do">## │├•objective:   minimum shortfall objective (`budget` = 8748.4908)</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="do">## │├•penalties:   none specified</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="do">## │├•targets:     relative targets (between 0.2 and 0.2)</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="do">## │├•constraints: none specified</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="do">## │└•decisions:   binary decision</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="do">## └•optimization</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="do">##  ├•portfolio:   default portfolio</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="do">##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="do">## # ℹ Use `summary(...)` to see complete formulation.</span></span></code></pre></div>
<p>After we have built a <code><a href="reference/problem.html">problem()</a></code>, we can solve it to obtain a solution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># solve the problem</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the objective</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s1</span>, <span class="st">"objective"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="do">## solution_1 </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="do">##    4.46285</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract time spent solving the problem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s1</span>, <span class="st">"runtime"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## solution_1 </span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="do">##      3.459</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract state message from the solver</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">s1</span>, <span class="st">"status"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="do">## solution_1 </span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="do">##  "OPTIMAL"</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the solution</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s1</span>, main <span class="op">=</span> <span class="st">"Solution"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-minimal_solution-1.png" width="500" style="display: block; margin: auto;"></p>
<p>After generating a solution, it is important to evaluate it. Here, we will calculate the number of planning units selected by the solution, and the total cost of the solution. We can also check how many representation targets are met by the solution.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate number of selected planning units by solution</span></span>
<span><span class="fu"><a href="reference/eval_n_summary.html">eval_n_summary</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">s1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="do">##   summary     n</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="do">##   &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="do">## 1 overall  2348</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate total cost of solution</span></span>
<span><span class="fu"><a href="reference/eval_cost_summary.html">eval_cost_summary</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">s1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="do">##   summary  cost</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="do">##   &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="do">## 1 overall 8748.</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate target coverage for the solution</span></span>
<span><span class="va">p1_target_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/eval_target_coverage_summary.html">eval_target_coverage_summary</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">s1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1_target_coverage</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="do">## # A tibble: 396 × 9</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="do">##    feature   met   total_amount absolute_target absolute_held absolute_shortfall</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;     &lt;lgl&gt;        &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;              &lt;dbl&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="do">##  1 Recurvir… TRUE         100.             20.0          23.4               0   </span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="do">##  2 Botaurus… TRUE          99.9            20.0          29.2               0   </span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="do">##  3 Botaurus… TRUE         100.             20.0          34.0               0   </span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="do">##  4 Corvus b… TRUE          99.9            20.0          20.4               0   </span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="do">##  5 Corvus b… FALSE         99.9            20.0          18.5               1.46</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="do">##  6 Cinclus … TRUE         100.             20.0          20.5               0   </span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="do">##  7 Spinus t… TRUE          99.9            20.0          22.6               0   </span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="do">##  8 Spinus t… TRUE          99.9            20.0          23.1               0   </span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="do">##  9 Falco sp… TRUE          99.9            20.0          24.9               0   </span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="do">## 10 Falco sp… TRUE         100.0            20.0          24.5               0   </span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="do">## # ℹ 386 more rows</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="do">## # ℹ 3 more variables: relative_target &lt;dbl&gt;, relative_held &lt;dbl&gt;,</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="do">## #   relative_shortfall &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check percentage of the features that have their target met given the solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p1_target_coverage</span><span class="op">$</span><span class="va">met</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="do">## [1] 96.21212</span></span></code></pre></div>
<p>Although this solution helps meet the representation targets, it does not account for existing protected areas inside the study area. As such, it does not account for the possibility that some features could be partially – or even fully – represented by existing protected areas and, in turn, might fail to identify meaningful priorities for new protected areas. To address this issue, we will use the <code><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_locked_in()</a></code> function to import spatial data for protected areas in the study area. We will then add constraints to the <code><a href="reference/problem.html">problem()</a></code> to ensure they are selected by the solution (via <code><a href="reference/add_locked_in_constraints.html">add_locked_in_constraints()</a></code>).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import locked in data</span></span>
<span><span class="va">wa_locked_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_locked_in</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wa_locked_in</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="do">## size        : 109, 147, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="do">## resolution  : 4000, 4000  (x, y)</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="do">## extent      : -1816382, -1228382, 247483.5, 683483.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="do">## coord. ref. : +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs </span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="do">## source      : wa_locked_in.tif </span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="do">## name        : protected areas </span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="do">## min value   :               0 </span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="do">## max value   :               1</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wa_locked_in</span>, main <span class="op">=</span> <span class="st">"Existing protected areas"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-locked_in_constraints-1.png" width="500" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create new problem with locked in constraints added to it</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">p1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_locked_in_constraints.html">add_locked_in_constraints</a></span><span class="op">(</span><span class="va">wa_locked_in</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># solve the problem</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the solution</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s2</span>, main <span class="op">=</span> <span class="st">"Solution"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-locked_in_constraints-2.png" width="500" style="display: block; margin: auto;"></p>
<p>This solution is an improvement over the previous solution. However, there are some places in the study area that are not available for protected area establishment (e.g., due to land tenure). As a consequence, the solution might not be practical for implementation, because it might select some places that are not available for protection. To address this issue, we will use the <code><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_locked_out()</a></code> function to import spatial data describing which planning units are not available for protection. We will then add constraints to the <code><a href="reference/problem.html">problem()</a></code> to ensure they are not selected by the solution (via <code><a href="reference/add_locked_out_constraints.html">add_locked_out_constraints()</a></code>).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import locked out data</span></span>
<span><span class="va">wa_locked_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://prioritizr.github.io/prioritizrdata/reference/wa_data.html" class="external-link">get_wa_locked_out</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wa_locked_out</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="do">## size        : 109, 147, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="do">## resolution  : 4000, 4000  (x, y)</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="do">## extent      : -1816382, -1228382, 247483.5, 683483.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="do">## coord. ref. : +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs </span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="do">## source      : wa_locked_out.tif </span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="do">## name        : urban areas </span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="do">## min value   :           0 </span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="do">## max value   :           1</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wa_locked_out</span>, main <span class="op">=</span> <span class="st">"Areas not available for protection"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-locked_out_constraints-1.png" width="500" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create new problem with locked out constraints added to it</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">p2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_locked_out_constraints.html">add_locked_out_constraints</a></span><span class="op">(</span><span class="va">wa_locked_out</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># solve the problem</span></span>
<span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the solution</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s3</span>, main <span class="op">=</span> <span class="st">"Solution"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-locked_out_constraints-2.png" width="500" style="display: block; margin: auto;"></p>
<p>This solution is even better then the previous solution. However, we are not finished yet. The planning units selected by the solution are fairly fragmented. This can cause issues because fragmentation increases management costs and reduces conservation benefits through edge effects. To address this issue, we can further modify the problem by adding penalties that punish overly fragmented solutions (via <code><a href="reference/add_boundary_penalties.html">add_boundary_penalties()</a></code>). Here we will use a penalty factor (i.e., boundary length modifier) of 0.003, and an edge factor of 50% so that planning units that occur on the outer edge of the study area are not overly penalized.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create new problem with boundary penalties added to it</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">p3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_boundary_penalties.html">add_boundary_penalties</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.003</span>, edge_factor <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># solve the problem</span></span>
<span><span class="va">s4</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/solve.html">solve</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the solution</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s4</span>, main <span class="op">=</span> <span class="st">"Solution"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-boundary_penalties-1.png" width="500" style="display: block; margin: auto;"></p>
<p>Now, let’s explore which planning units selected by the solution are most important for cost-effectively meeting the targets. To achieve this, we will calculate importance (irreplaceability) scores using an incremental rank approach. Briefly, the optimization problem is solved multiple times in an incremental process with increasing budgets, and planning units are assigned ranks based on which increment they are selected in. Planning units selected earlier on in the process are considered more important.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate importance scores</span></span>
<span><span class="va">imp</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">p4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/eval_rank_importance.html">eval_rank_importance</a></span><span class="op">(</span><span class="va">s4</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="do">## class       : SpatRaster </span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="do">## size        : 109, 147, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="do">## resolution  : 4000, 4000  (x, y)</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="do">## extent      : -1816382, -1228382, 247483.5, 683483.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="do">## coord. ref. : +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +ellps=sphere +units=m +no_defs </span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="do">## source(s)   : memory</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="do">## varname     : wa_pu </span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="do">## name        : rs </span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="do">## min value   :  0 </span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="do">## max value   :  1</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set planning units that are locked in to -1 so we can easily</span></span>
<span><span class="co"># see importance scores for priority areas</span></span>
<span><span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">imp</span>, <span class="va">s4</span>, maskvalues <span class="op">=</span> <span class="fl">0</span>, updatevalue <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the total importance scores</span></span>
<span><span class="co">## planning units shown in purple were not selected in solution s4</span></span>
<span><span class="co">## planning units shown in blue are less important</span></span>
<span><span class="co">## planning units shown in yellow are highly important</span></span>
<span><span class="co">## note that locked in planning units are also shown in yellow</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,  main <span class="op">=</span> <span class="st">"Importance scores"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-importance-1.png" width="500" style="display: block; margin: auto;"></p>
<p>This short example demonstrates how the <em>prioritizr R</em> package can be used to build and customize conservation problems, and then solve them to generate solutions. Although we explored just a few different functions for modifying a conservation problem, the package provides many functions for specifying objectives, constraints, penalties, and decision variables, so that you can build and custom-tailor conservation planning problems to suit your planning scenario.</p>
</div>
<div class="section level2">
<h2 id="learning-resources">Learning resources<a class="anchor" aria-label="anchor" href="#learning-resources"></a>
</h2>
<p>The <a href="https://prioritizr.net/index.html">package website</a> contains information on the <em>prioritizr R</em> package. Here you can find <a href="https://prioritizr.net/reference/index.html">documentation for every function and built-in dataset</a>, and <a href="https://prioritizr.net/news/index.html">news describing the updates in each package version</a>. It also contains the following articles and tutorials.</p>
<ul>
<li>
<a href="https://prioritizr.net/articles/prioritizr.html"><strong>Getting started</strong></a>: Short tutorial on using the package.</li>
<li>
<a href="https://prioritizr.net/articles/package_overview.html"><strong>Package overview</strong></a>: Introduction to systematic conservation planning and a comprehensive overview of the package.</li>
<li>
<a href="https://prioritizr.net/articles/connectivity_tutorial.html"><strong>Connectivity tutorial</strong></a>: Tutorial on incorporating connectivity into prioritizations.</li>
<li>
<a href="https://prioritizr.net/articles/calibrating_trade-offs_tutorial.html"><strong>Calibrating trade-offs tutorial</strong></a>: Tutorial on running calibration analyses to satisfy multiple criteria.</li>
<li>
<a href="https://prioritizr.net/articles/management_zones_tutorial.html"><strong>Management zones tutorial</strong></a>: Tutorial on incorporating multiple management zones and actions into prioritizations.</li>
<li>
<a href="https://prioritizr.net/articles/gurobi_installation_guide.html"><strong>Gurobi installation guide</strong></a>: Instructions for installing the <em>Gurobi</em> optimization suite for generating prioritizations.</li>
<li>
<a href="https://prioritizr.net/articles/solver_benchmarks.html"><strong>Solver benchmarks</strong></a>: Performance comparison of optimization solvers for generating prioritizations.</li>
<li>
<a href="https://prioritizr.net/articles/publication_record.html"><strong>Publication record</strong></a>: List of publications that have cited the package.</li>
</ul>
<p>Additional resources can also be found in <a href="https://github.com/prioritizr" class="external-link">online repositories under the <em>prioritizr</em> organization</a>. These resources include <a href="https://github.com/prioritizr/teaching" class="external-link">slides for talks and seminars about the package</a>. Additionally, workshop materials are available too (e.g., the <a href="https://prioritizr.github.io/workshop/" class="external-link">Carleton 2023 workshop</a> and <a href="https://iiasa.github.io/eccb2024/" class="external-link">ECCB 2024 workshop</a>).</p>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>If you have any questions about the <em>prioritizr R</em> package or suggestions for improving it, please <a href="https://github.com/prioritizr/prioritizr/issues/new" class="external-link">post an issue on the code repository</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=prioritizr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/prioritizr/prioritizr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/prioritizr/prioritizr/issues" class="external-link">Report a bug</a></li>
<li><a href="http://prioritizr.net/CONTRIBUTING.html" class="external-link">Learn about contributing</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing prioritizr</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4716-6134" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>
<a href="http://www.richard-schuster.com" class="external-link">Richard Schuster</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3191-7869" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Nina Morrell <br><small class="roles"> Author </small>   </li>
<li>
<a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8929-7776" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Brandon P M Edwards <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-0865-3076" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Matthew E Watts <br><small class="roles"> Author </small>   </li>
<li>
<a href="https://arcese.forestry.ubc.ca" class="external-link">Peter Arcese</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8097-482X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Joseph R Bennett <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3901-9513" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>
<a href="http://www.possinghamlab.org" class="external-link">Hugh P Possingham</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-7755-996X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/Lifecycle-stable-brightgreen.svg" alt="lifecycle"></a></li>
<li><a href="https://github.com/prioritizr/prioritizr/actions" class="external-link"><img src="https://img.shields.io/github/actions/workflow/status/prioritizr/prioritizr/R-CMD-check-ubuntu.yaml?branch=main&amp;label=Ubuntu" alt="R-CMD-check-Ubuntu"></a></li>
<li><a href="https://github.com/prioritizr/prioritizr/actions" class="external-link"><img src="https://img.shields.io/github/actions/workflow/status/prioritizr/prioritizr/R-CMD-check-windows.yaml?branch=main&amp;label=Windows" alt="R-CMD-check-Windows"></a></li>
<li><a href="https://github.com/prioritizr/prioritizr/actions" class="external-link"><img src="https://img.shields.io/github/actions/workflow/status/prioritizr/prioritizr/R-CMD-check-macos.yaml?branch=main&amp;label=macOS" alt="R-CMD-check-macOS"></a></li>
<li><a href="https://github.com/prioritizr/prioritizr/actions" class="external-link"><img src="https://img.shields.io/github/actions/workflow/status/prioritizr/prioritizr/documentation.yaml?branch=main&amp;label=Documentation" alt="Documentation"></a></li>
<li><a href="https://app.codecov.io/gh/prioritizr/prioritizr/branch/main" class="external-link"><img src="https://img.shields.io/codecov/c/github/prioritizr/prioritizr?label=Coverage" alt="Coverage-Status"></a></li>
<li><a href="https://CRAN.R-project.org/package=prioritizr" class="external-link"><img src="https://www.r-pkg.org/badges/version/prioritizr" alt="CRAN-Status-Badge"></a></li>
<li><a href="https://www.theodorosploumis.com/en" class="external-link"><img src="https://img.shields.io/badge/Logo%20by-Theodoros%20Ploumis-blue.svg" alt="logo"></a></li>
<li><a href="https://doi.org/10.1111/cobi.14376" class="external-link"><img src="https://img.shields.io/badge/Publication-10.1111/cobi.14376-blue.svg" alt="publication"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com" class="external-link">Richard Schuster</a>, Nina Morrell, <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Brandon P M Edwards, Matthew E Watts, <a href="https://arcese.forestry.ubc.ca" class="external-link">Peter Arcese</a>, Joseph R Bennett, <a href="http://www.possinghamlab.org" class="external-link">Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
